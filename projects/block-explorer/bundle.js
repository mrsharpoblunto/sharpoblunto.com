!function(t){function e(n){if(r[n])return r[n].exports;var a=r[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,e),a.l=!0,a.exports}var r={};return e.m=t,e.c=r,e.i=function(t){return t},e.d=function(t,e,r){Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=25)}([function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.ScoreComponent=e.SpecimenComponent=e.CameraComponent=e.RoverComponent=e.GroundComponent=void 0;var a=r(21),o=n(a),i=r(20),u=n(i),l=r(22),s=n(l),f=r(24),c=n(f),h=r(23),d=n(h);e.GroundComponent=o["default"],e.RoverComponent=s["default"],e.CameraComponent=u["default"],e.SpecimenComponent=c["default"],e.ScoreComponent=d["default"]},function(t,e,r){e.glMatrix=r(3),e.mat2=r(34),e.mat2d=r(35),e.mat3=r(7),e.mat4=r(36),e.quat=r(37),e.vec2=r(38),e.vec3=r(8),e.vec4=r(9)},function(t,e,r){var n,a,o;/**
 * @license twgl.js 1.7.2 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
 * Available via the MIT license.
 * see: http://github.com/greggman/twgl.js for details
 */
/**
 * @license almond 0.3.1 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */
!function(r,i){a=[],n=i,o="function"==typeof n?n.apply(e,a):n,!(void 0!==o&&(t.exports=o)),"undefined"!=typeof t&&t.exports?t.exports=i():r.twgl=i()}(this,function(){/**
 * @license almond 0.3.1 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */
var t,e,r;return function(n){function a(t,e){return g.call(t,e)}function o(t,e){var r,n,a,o,i,u,l,s,f,c,h,d=e&&e.split("/"),v=y.map,m=v&&v["*"]||{};if(t&&"."===t.charAt(0))if(e){for(t=t.split("/"),i=t.length-1,y.nodeIdCompat&&S.test(t[i])&&(t[i]=t[i].replace(S,"")),t=d.slice(0,d.length-1).concat(t),f=0;f<t.length;f+=1)if(h=t[f],"."===h)t.splice(f,1),f-=1;else if(".."===h){if(1===f&&(".."===t[2]||".."===t[0]))break;f>0&&(t.splice(f-1,2),f-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((d||m)&&v){for(r=t.split("/"),f=r.length;f>0;f-=1){if(n=r.slice(0,f).join("/"),d)for(c=d.length;c>0;c-=1)if(a=v[d.slice(0,c).join("/")],a&&(a=a[n])){o=a,u=f;break}if(o)break;!l&&m&&m[n]&&(l=m[n],s=f)}!o&&l&&(o=l,u=s),o&&(r.splice(0,u,o),t=r.join("/"))}return t}function i(t,e){return function(){var r=x.call(arguments,0);return"string"!=typeof r[0]&&1===r.length&&r.push(null),d.apply(n,r.concat([t,e]))}}function u(t){return function(e){return o(e,t)}}function l(t){return function(e){p[t]=e}}function s(t){if(a(M,t)){var e=M[t];delete M[t],_[t]=!0,h.apply(n,e)}if(!a(p,t)&&!a(_,t))throw new Error("No "+t);return p[t]}function f(t){var e,r=t?t.indexOf("!"):-1;return r>-1&&(e=t.substring(0,r),t=t.substring(r+1,t.length)),[e,t]}function c(t){return function(){return y&&y.config&&y.config[t]||{}}}var h,d,v,m,p={},M={},y={},_={},g=Object.prototype.hasOwnProperty,x=[].slice,S=/\.js$/;v=function(t,e){var r,n=f(t),a=n[0];return t=n[1],a&&(a=o(a,e),r=s(a)),a?t=r&&r.normalize?r.normalize(t,u(e)):o(t,e):(t=o(t,e),n=f(t),a=n[0],t=n[1],a&&(r=s(a))),{f:a?a+"!"+t:t,n:t,pr:a,p:r}},m={notrequirebecasebrowserifymessesup:function(t){return i(t)},exports:function(t){var e=p[t];return"undefined"!=typeof e?e:p[t]={}},module:function(t){return{id:t,uri:"",exports:p[t],config:c(t)}}},h=function(t,e,r,o){var u,f,c,h,d,y,g=[],x=typeof r;if(o=o||t,"undefined"===x||"function"===x){for(e=!e.length&&r.length?["notrequirebecasebrowserifymessesup","exports","module"]:e,d=0;d<e.length;d+=1)if(h=v(e[d],o),f=h.f,"notrequirebecasebrowserifymessesup"===f)g[d]=m.notrequirebecasebrowserifymessesup(t);else if("exports"===f)g[d]=m.exports(t),y=!0;else if("module"===f)u=g[d]=m.module(t);else if(a(p,f)||a(M,f)||a(_,f))g[d]=s(f);else{if(!h.p)throw new Error(t+" missing "+f);h.p.load(h.n,i(o,!0),l(f),{}),g[d]=p[f]}c=r?r.apply(p[t],g):void 0,t&&(u&&u.exports!==n&&u.exports!==p[t]?p[t]=u.exports:c===n&&y||(p[t]=c))}else t&&(p[t]=r)},t=e=d=function(t,e,r,a,o){if("string"==typeof t)return m[t]?m[t](e):s(v(t,e).f);if(!t.splice){if(y=t,y.deps&&d(y.deps,y.callback),!e)return;e.splice?(t=e,e=r,r=null):t=n}return e=e||function(){},"function"==typeof r&&(r=a,a=o),a?h(n,t,e,r):setTimeout(function(){h(n,t,e,r)},4),d},d.config=function(t){return d(t)},t._defined=p,r=function(t,e,r){if("string"!=typeof t)throw new Error("See almond README: incorrect module build, no module name");e.splice||(r=e,e=[]),a(p,t)||a(M,t)||(M[t]=[t,e,r])},r.amd={jQuery:!0}}(),r("node_modules/almond/almond.js",function(){}),r("twgl/typedarrays",[],function(){function t(t){if(t instanceof Int8Array)return n;if(t instanceof Uint8Array)return a;if(t instanceof Uint8ClampedArray)return a;if(t instanceof Int16Array)return o;if(t instanceof Uint16Array)return i;if(t instanceof Int32Array)return u;if(t instanceof Uint32Array)return l;if(t instanceof Float32Array)return s;throw"unsupported typed array type"}function e(t){switch(t){case n:return Int8Array;case a:return Uint8Array;case o:return Int16Array;case i:return Uint16Array;case u:return Int32Array;case l:return Uint32Array;case s:return Float32Array;default:throw"unknown gl type"}}function r(t){return t&&t.buffer&&t.buffer instanceof ArrayBuffer}var n=5120,a=5121,o=5122,i=5123,u=5124,l=5125,s=5126;return{getGLTypeForTypedArray:t,getTypedArrayTypeForGLType:e,isArrayBuffer:r}}),r("twgl/utils",[],function(){function t(t){var e={};return Object.keys(t).forEach(function(r){e[r]=t[r]}),e}function e(t,e,r){t.forEach(function(t){var n=e[t];void 0!==n&&(r[t]=n)})}function r(t,e){Object.keys(e).forEach(function(r){e.hasOwnProperty(r)&&t.hasOwnProperty(r)&&(e[r]=t[r])})}function n(t){return parseFloat(t.getParameter(t.VERSION).substr(6))}function a(t){return 0===t.getParameter(t.VERSION).indexOf("WebGL 2.0")}function o(t){var e=n(t);return e<=1&&e>0}var i=window.console&&window.console.error&&"function"==typeof window.console.error?window.console.error.bind(window.console):function(){},u=window.console&&window.console.warn&&"function"==typeof window.console.warn?window.console.warn.bind(window.console):function(){};return{copyExistingProperties:r,copyNamedProperties:e,shallowCopy:t,isWebGL1:o,isWebGL2:a,error:i,warn:u}}),r("twgl/attributes",["./typedarrays","./utils"],function(t,e){function r(t){y.attribPrefix=t}function n(t){e.copyExistingProperties(t,y)}function a(t,e,r,n,a){t.bindBuffer(e,r),t.bufferData(e,n,a||t.STATIC_DRAW)}function o(t,e,r,n){if(e instanceof WebGLBuffer)return e;r=r||t.ARRAY_BUFFER;var o=t.createBuffer();return a(t,r,o,e,n),o}function i(t){return"indices"===t}function u(t){return t instanceof Int8Array||t instanceof Uint8Array}function l(t){return t.length?t:t.data}function s(t,e){var r;if(r=t.indexOf("coord")>=0?2:t.indexOf("color")>=0?4:3,e%r>0)throw"can not guess numComponents. You should specify it.";return r}function f(t,e){return t.numComponents||t.size||s(e,l(t).length)}function c(e,r){if(t.isArrayBuffer(e))return e;if(t.isArrayBuffer(e.data))return e.data;Array.isArray(e)&&(e={data:e});var n=e.type;return n||(n="indices"===r?Uint16Array:Float32Array),new n(e.data)}function h(e,r){var n={};return Object.keys(r).forEach(function(a){if(!i(a)){var l=r[a],s=l.attrib||l.name||l.attribName||y.attribPrefix+a,h=c(l,a);n[s]={buffer:o(e,h,void 0,l.drawType),numComponents:f(l,a),type:t.getGLTypeForTypedArray(h),normalize:void 0!==l.normalize?l.normalize:u(h),stride:l.stride||0,offset:l.offset||0,drawType:l.drawType}}}),n}function d(t,e,r,n){r=c(r),n?(t.bindBuffer(t.ARRAY_BUFFER,e.buffer),t.bufferSubData(t.ARRAY_BUFFER,n,r)):a(t,t.ARRAY_BUFFER,e.buffer,r,e.drawType)}function v(e,r){var n={attribs:h(e,r)},a=r.indices;return a?(a=c(a,"indices"),n.indices=o(e,a,e.ELEMENT_ARRAY_BUFFER),n.numElements=a.length,n.elementType=t.getGLTypeForTypedArray(a)):n.numElements=_(r),n}function m(t,e,r){var n="indices"===r?t.ELEMENT_ARRAY_BUFFER:t.ARRAY_BUFFER,a=c(e,r);return o(t,a,n)}function p(t,e){var r={};return Object.keys(e).forEach(function(n){r[n]=m(t,e[n],n)}),r}function M(t,e,r){var n=t.createVertexArray();return t.bindVertexArray(n),e.length||(e=[e]),e.forEach(function(e){twgl.setBuffersAndAttributes(t,e,r)}),t.bindVertexArray(null),{numElements:r.numElements,elementType:r.elementType,vertexArrayObject:n}}var y={attribPrefix:""},_=function(){var t=["position","positions","a_position"];return function(e){for(var r,n=0;n<t.length&&(r=t[n],!(r in e));++n);n===t.length&&(r=Object.keys(e)[0]);var a=e[r],o=l(a).length,i=f(a,r),u=o/i;if(o%i>0)throw"numComponents "+i+" not correct for length "+o;return u}}();return{createAttribsFromArrays:h,createBuffersFromArrays:p,createBufferFromArray:m,createBufferFromTypedArray:o,createBufferInfoFromArrays:v,setAttribInfoBufferFromArray:d,createVertexArrayInfo:M,setAttributePrefix:r,setDefaults_:n,getNumComponents_:f,getArray_:l}}),r("twgl/programs",["./utils"],function(t){function e(t,e){return Lt[e].bindPoint}function r(t,e){return function(r){t.uniform1f(e,r)}}function n(t,e){return function(r){t.uniform1fv(e,r)}}function a(t,e){return function(r){t.uniform2fv(e,r)}}function o(t,e){return function(r){t.uniform3fv(e,r)}}function i(t,e){return function(r){t.uniform4fv(e,r)}}function u(t,e){return function(r){t.uniform1i(e,r)}}function l(t,e){return function(r){t.uniform1iv(e,r)}}function s(t,e){return function(r){t.uniform2iv(e,r)}}function f(t,e){return function(r){t.uniform3iv(e,r)}}function c(t,e){return function(r){t.uniform4iv(e,r)}}function h(t,e){return function(r){t.uniform1ui(e,r)}}function d(t,e){return function(r){t.uniform1uiv(e,r)}}function v(t,e){return function(r){t.uniform2uiv(e,r)}}function m(t,e){return function(r){t.uniform3uiv(e,r)}}function p(t,e){return function(r){t.uniform4uiv(e,r)}}function M(t,e){return function(r){t.uniformMatrix2fv(e,!1,r)}}function y(t,e){return function(r){t.uniformMatrix3fv(e,!1,r)}}function _(t,e){return function(r){t.uniformMatrix4fv(e,!1,r)}}function g(t,e){return function(r){t.uniformMatrix2x3fv(e,!1,r)}}function x(t,e){return function(r){t.uniformMatrix3x2fv(e,!1,r)}}function S(t,e){return function(r){t.uniformMatrix2x4fv(e,!1,r)}}function b(t,e){return function(r){t.uniformMatrix4x2fv(e,!1,r)}}function I(t,e){return function(r){t.uniformMatrix3x4fv(e,!1,r)}}function w(t,e){return function(r){t.uniformMatrix4x3fv(e,!1,r)}}function E(t,r,n,a){var o=e(t,r);return function(e){t.uniform1i(a,n),t.activeTexture(t.TEXTURE0+n),t.bindTexture(o,e)}}function D(t,r,n,a,o){for(var i=e(t,r),u=new Int32Array(o),l=0;l<o;++l)u[l]=n+l;return function(e){t.uniform1iv(a,u),e.forEach(function(e,r){t.activeTexture(t.TEXTURE0+u[r]),t.bindTexture(i,e)})}}function F(t,e){return e=e||0,++e,t.split("\n").map(function(t,r){return r+e+": "+t}).join("\n")}function A(t,e,r,n){var a=n||W,o=t.createShader(r),i=0;Bt.test(e)&&(i=1,e=e.replace(Bt,"")),t.shaderSource(o,e),t.compileShader(o);var u=t.getShaderParameter(o,t.COMPILE_STATUS);if(!u){var l=t.getShaderInfoLog(o);return a(F(e,i)+"\n*** Error compiling shader: "+l),t.deleteShader(o),null}return o}function T(t,e,r,n,a){"function"==typeof n&&(a=n,n=void 0),"function"==typeof r&&(a=r,r=void 0);var o=a||W,i=t.createProgram();e.forEach(function(e){t.attachShader(i,e)}),r&&r.forEach(function(e,r){t.bindAttribLocation(i,n?n[r]:r,e)}),t.linkProgram(i);var u=t.getProgramParameter(i,t.LINK_STATUS);if(!u){var l=t.getProgramInfoLog(i);return o("Error in program linking:"+l),t.deleteProgram(i),null}return i}function P(t,e,r,n){var a,o="",i=document.getElementById(e);if(!i)throw"*** Error: unknown script element"+e;if(o=i.text,!r)if("x-shader/x-vertex"===i.type)a=t.VERTEX_SHADER;else if("x-shader/x-fragment"===i.type)a=t.FRAGMENT_SHADER;else if(a!==t.VERTEX_SHADER&&a!==t.FRAGMENT_SHADER)throw"*** Error: unknown shader type";return A(t,o,r?r:a,n)}function R(t,e,r,n,a){for(var o=[],i=0;i<e.length;++i){var u=P(t,e[i],t[Vt[i]],a);if(!u)return null;o.push(u)}return T(t,o,r,n,a)}function C(t,e,r,n,a){for(var o=[],i=0;i<e.length;++i){var u=A(t,e[i],t[Vt[i]],a);if(!u)return null;o.push(u)}return T(t,o,r,n,a)}function O(t,e){function r(e,r){var a=t.getUniformLocation(e,r.name),o=r.size>1&&"[0]"===r.name.substr(-3),i=r.type,u=Lt[i];if(!u)throw"unknown type: 0x"+i.toString(16);if(u.bindPoint){var l=n;return n+=r.size,o?u.arraySetter(t,i,l,a,r.size):u.setter(t,i,l,a,r.size)}return u.arraySetter&&o?u.arraySetter(t,a):u.setter(t,a)}for(var n=0,a={},o=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),i=0;i<o;++i){var u=t.getActiveUniform(e,i);if(!u)break;var l=u.name;"[0]"===l.substr(-3)&&(l=l.substr(0,l.length-3));var s=r(e,u);a[l]=s}return a}function z(t,e){for(var r=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),n=[],a=[],o=0;o<r;++o){a.push(o),n.push({});var i=t.getActiveUniform(e,o);if(!i)break;n[o].name=i.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach(function(r){var o=r[0],i=r[1];t.getActiveUniforms(e,a,t[o]).forEach(function(t,e){n[e][i]=t})});var u={},l=t.getProgramParameter(e,t.ACTIVE_UNIFORM_BLOCKS);for(o=0;o<l;++o){var s=t.getActiveUniformBlockName(e,o),f={index:o,usedByVertexShader:t.getActiveUniformBlockParameter(e,o,t.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER),usedByFragmentShader:t.getActiveUniformBlockParameter(e,o,t.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER),size:t.getActiveUniformBlockParameter(e,o,t.UNIFORM_BLOCK_DATA_SIZE),uniformIndices:t.getActiveUniformBlockParameter(e,o,t.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES)};f.used=f.usedByVertexSahder||f.usedByFragmentShader,u[s]=f}return{blockSpecs:u,uniformData:n}}function k(t,e,r,n){var a=r.blockSpecs,o=r.uniformData,i=a[n];if(!i)return H("no uniform block object named:",n),{name:n,uniforms:{}};var u=new ArrayBuffer(i.size),l=t.createBuffer(),s=i.index;t.bindBuffer(t.UNIFORM_BUFFER,l),t.uniformBlockBinding(e,i.index,s);var f=n+".";qt.test(f)&&(f=f.replace(qt,"."));var c={};return i.uniformIndices.forEach(function(t){var e=o[t],r=Lt[e.type],n=r.Type,a=e.size*r.size,i=e.name;i.substr(0,f.length)===f&&(i=i.substr(f.length)),c[i]=new n(u,e.offset,a/n.BYTES_PER_ELEMENT)}),{name:n,array:u,asFloat:new Float32Array(u),buffer:l,uniforms:c}}function U(t,e,r){return k(t,e.program,e.uniformBlockSpec,r)}function N(t,e,r){var n=e.uniformBlockSpec||e,a=n.blockSpecs[r.name];if(a){var o=a.index;return t.bindBufferRange(t.UNIFORM_BUFFER,o,r.buffer,0,r.array.byteLength),!0}return!1}function L(t,e,r){N(t,e,r)&&t.bufferData(t.UNIFORM_BUFFER,r.array,t.DYNAMIC_DRAW)}function B(t,e){var r=t.uniforms;for(var n in e){var a=r[n];if(a){var o=e[n];o.length?a.set(o):a[0]=o}}}function V(t,e){for(var r=t.uniformSetters||t,n=arguments.length,a=1;a<n;++a){var o=arguments[a];if(Array.isArray(o))for(var i=o.length,u=0;u<i;++u)V(r,o[u]);else for(var l in o){var s=r[l];s&&s(o[l])}}}function q(t,e){function r(e){return function(r){t.bindBuffer(t.ARRAY_BUFFER,r.buffer),t.enableVertexAttribArray(e),t.vertexAttribPointer(e,r.numComponents||r.size,r.type||t.FLOAT,r.normalize||!1,r.stride||0,r.offset||0)}}for(var n={},a=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),o=0;o<a;++o){var i=t.getActiveAttrib(e,o);if(!i)break;var u=t.getAttribLocation(e,i.name);n[i.name]=r(u)}return n}function j(t,e){for(var r in e){var n=t[r];n&&n(e[r])}}function Y(t,e,r){r.vertexArrayObject?t.bindVertexArray(r.vertexArrayObject):(j(e.attribSetters||e,r.attribs),r.indices&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r.indices))}function G(e,r){var n=O(e,r),a=q(e,r),o={program:r,uniformSetters:n,attribSetters:a};return t.isWebGL2(e)&&(o.uniformBlockSpec=z(e,r)),o}function X(t,e,r,n,a){"function"==typeof n&&(a=n,n=void 0),"function"==typeof r&&(a=r,r=void 0);var o=a||W,i=!0;if(e=e.map(function(t){if(t.indexOf("\n")<0){var e=document.getElementById(t);e?t=e.text:(o("no element with id: "+t),i=!1)}return t}),!i)return null;var u=C(t,e,r,n,a);return u?G(t,u):null}var W=t.error,H=t.warn,Q=5126,K=35664,Z=35665,$=35666,J=5124,tt=35667,et=35668,rt=35669,nt=35670,at=35671,ot=35672,it=35673,ut=35674,lt=35675,st=35676,ft=35678,ct=35680,ht=35679,dt=35682,vt=35685,mt=35686,pt=35687,Mt=35688,yt=35689,_t=35690,gt=36289,xt=36292,St=36293,bt=5125,It=36294,wt=36295,Et=36296,Dt=36298,Ft=36299,At=36300,Tt=36303,Pt=36306,Rt=36307,Ct=36308,Ot=36311,zt=3553,kt=34067,Ut=32879,Nt=35866,Lt={};Lt[Q]={Type:Float32Array,size:4,setter:r,arraySetter:n},Lt[K]={Type:Float32Array,size:8,setter:a},Lt[Z]={Type:Float32Array,size:12,setter:o},Lt[$]={Type:Float32Array,size:16,setter:i},Lt[J]={Type:Int32Array,size:4,setter:u,arraySetter:l},Lt[tt]={Type:Int32Array,size:8,setter:s},Lt[et]={Type:Int32Array,size:12,setter:f},Lt[rt]={Type:Int32Array,size:16,setter:c},Lt[bt]={Type:Uint32Array,size:4,setter:h,arraySetter:d},Lt[It]={Type:Uint32Array,size:8,setter:v},Lt[wt]={Type:Uint32Array,size:12,setter:m},Lt[Et]={Type:Uint32Array,size:16,setter:p},Lt[nt]={Type:Uint32Array,size:4,setter:u,arraySetter:l},Lt[at]={Type:Uint32Array,size:8,setter:s},Lt[ot]={Type:Uint32Array,size:12,setter:f},Lt[it]={Type:Uint32Array,size:16,setter:c},Lt[ut]={Type:Float32Array,size:16,setter:M},Lt[lt]={Type:Float32Array,size:36,setter:y},Lt[st]={Type:Float32Array,size:64,setter:_},Lt[vt]={Type:Float32Array,size:24,setter:g},Lt[mt]={Type:Float32Array,size:32,setter:S},Lt[pt]={Type:Float32Array,size:24,setter:x},Lt[Mt]={Type:Float32Array,size:48,setter:I},Lt[yt]={Type:Float32Array,size:32,setter:b},Lt[_t]={Type:Float32Array,size:48,setter:w},Lt[ft]={Type:null,size:0,setter:E,arraySetter:D,bindPoint:zt},Lt[ct]={Type:null,size:0,setter:E,arraySetter:D,bindPoint:kt},Lt[ht]={Type:null,size:0,setter:E,arraySetter:D,bindPoint:Ut},Lt[dt]={Type:null,size:0,setter:E,arraySetter:D,bindPoint:zt},Lt[gt]={Type:null,size:0,setter:E,arraySetter:D,bindPoint:Nt},Lt[xt]={Type:null,size:0,setter:E,arraySetter:D,bindPoint:Nt},Lt[St]={Type:null,size:0,setter:E,arraySetter:D,bindPoint:kt},Lt[Dt]={Type:null,size:0,setter:E,arraySetter:D,bindPoint:zt},Lt[Ft]={Type:null,size:0,setter:E,arraySetter:D,bindPoint:Ut},Lt[At]={Type:null,size:0,setter:E,arraySetter:D,bindPoint:kt},Lt[Tt]={Type:null,size:0,setter:E,arraySetter:D,bindPoint:Nt},Lt[Pt]={Type:null,size:0,setter:E,arraySetter:D,bindPoint:zt},Lt[Rt]={Type:null,size:0,setter:E,arraySetter:D,bindPoint:Ut},Lt[Ct]={Type:null,size:0,setter:E,arraySetter:D,bindPoint:kt},Lt[Ot]={Type:null,size:0,setter:E,arraySetter:D,bindPoint:Nt};var Bt=/^[ \t]*\n/,Vt=["VERTEX_SHADER","FRAGMENT_SHADER"],qt=/\[\d+\]\.$/;return{createAttributeSetters:q,createProgram:T,createProgramFromScripts:R,createProgramFromSources:C,createProgramInfo:X,createProgramInfoFromProgram:G,createUniformSetters:O,createUniformBlockSpecFromProgram:z,createUniformBlockInfoFromProgram:k,createUniformBlockInfo:U,setAttributes:j,setBuffersAndAttributes:Y,setUniforms:V,setUniformBlock:L,setBlockUniforms:B,bindUniformBlock:N}}),r("twgl/draw",["./programs"],function(t){function e(t,e,r,n,a){var o=r.indices,i=r.elementType,u=void 0===n?r.numElements:n;a=void 0===a?0:a,i||o?t.drawElements(e,u,void 0===i?t.UNSIGNED_SHORT:r.elementType,a):t.drawArrays(e,a,u)}function r(r,n){var a=null,o=null;n.forEach(function(n){if(n.active!==!1){var i=n.programInfo,u=n.vertexArrayInfo||n.bufferInfo,l=!1,s=void 0===n.type?r.TRIANGLES:n.type;i!==a&&(a=i,r.useProgram(i.program),l=!0),(l||u!==o)&&(o&&o.vertexArrayObject&&!u.vertexArrayObject&&r.bindVertexArray(null),o=u,t.setBuffersAndAttributes(r,i,u)),t.setUniforms(i,n.uniforms),e(r,s,u,n.count,n.offset)}}),o.vertexArrayObject&&r.bindVertexArray(null)}return{drawBufferInfo:e,drawObjectList:r}}),r("twgl/textures",["./typedarrays","./utils"],function(t,e){function r(t){E.textureColor=new Uint8Array([255*t[0],255*t[1],255*t[2],255*t[3]])}function n(t){e.copyExistingProperties(t,E),t.textureColor&&r(t.textureColor)}function a(t,e){void 0!==e.colorspaceConversion&&(O.colorspaceConversion=t.getParameter(t.UNPACK_COLORSPACE_CONVERSION_WEBGL),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.colorspaceConversion)),void 0!==e.premultiplyAlpha&&(O.premultiplyAlpha=t.getParameter(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha)),void 0!==e.flipY&&(O.flipY=t.getParameter(t.UNPACK_FLIP_Y_WEBGL),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e.flipY))}function o(t,e){void 0!==e.colorspaceConversion&&t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,O.colorspaceConversion),void 0!==e.premultiplyAlpha&&t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,O.premultiplyAlpha),void 0!==e.flipY&&t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,O.flipY)}function i(t,e,r){var n=r.target||t.TEXTURE_2D;t.bindTexture(n,e),r.min&&t.texParameteri(n,t.TEXTURE_MIN_FILTER,r.min),r.mag&&t.texParameteri(n,t.TEXTURE_MAG_FILTER,r.mag),r.wrap&&(t.texParameteri(n,t.TEXTURE_WRAP_S,r.wrap),t.texParameteri(n,t.TEXTURE_WRAP_T,r.wrap),n===t.TEXTURE_3D&&t.texParameteri(n,t.TEXTURE_WRAP_R,r.wrap)),r.wrapR&&t.texParameteri(n,t.TEXTURE_WRAP_R,r.wrapR),r.wrapS&&t.texParameteri(n,t.TEXTURE_WRAP_S,r.wrapS),r.wrapT&&t.texParameteri(n,t.TEXTURE_WRAP_T,r.wrapT),r.minLod&&t.texParameteri(n,t.TEXTURE_MIN_LOD,r.minLod),r.maxLod&&t.texParameteri(n,t.TEXTURE_MAX_LOD,r.maxLod),r.baseLevel&&t.texParameteri(n,t.TEXTURE_BASE_LEVEL,r.baseLevel),r.maxLevel&&t.texParameteri(n,t.TEXTURE_MAX_LEVEL,r.maxLevel)}function u(t){return t=t||E.textureColor,D(t)?t:new Uint8Array([255*t[0],255*t[1],255*t[2],255*t[3]])}function l(t){return 0===(t&t-1)}function s(t,e,r,n,a){r=r||E.textureOptions;var o=r.target||t.TEXTURE_2D;n=n||r.width,a=a||r.height,t.bindTexture(o,e),l(n)&&l(a)?t.generateMipmap(o):(t.texParameteri(o,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(o,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(o,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE))}function f(t,e){return e=e||{},e.cubeFaceOrder||[t.TEXTURE_CUBE_MAP_POSITIVE_X,t.TEXTURE_CUBE_MAP_NEGATIVE_X,t.TEXTURE_CUBE_MAP_POSITIVE_Y,t.TEXTURE_CUBE_MAP_NEGATIVE_Y,t.TEXTURE_CUBE_MAP_POSITIVE_Z,t.TEXTURE_CUBE_MAP_NEGATIVE_Z]}function c(t,e){var r=f(t,e),n=r.map(function(t,e){return{face:t,ndx:e}});return n.sort(function(t,e){return t.face-e.face}),n}function h(){}function d(t,r,n){function a(){u.removeEventListener("error",o),u.removeEventListener("load",i),u=null}function o(){var r="couldn't load image: "+t;e.error(r),n(r,u),a()}function i(){n(null,u),a()}n=n||h;var u=new Image;return r=void 0!==r?r:E.crossOrigin,void 0!==r&&(u.crossOrigin=r),u.addEventListener("error",o),u.addEventListener("load",i),u.src=t,u}function v(t,e,r){r=r||E.textureOptions;var n=r.target||t.TEXTURE_2D;if(t.bindTexture(n,e),r.color!==!1){var a=u(r.color);if(n===t.TEXTURE_CUBE_MAP)for(var o=0;o<6;++o)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+o,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,a);else n===t.TEXTURE_3D?t.texImage3D(n,0,t.RGBA,1,1,1,0,t.RGBA,t.UNSIGNED_BYTE,a):t.texImage2D(n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,a)}}function m(t,r,n,a){a=a||h,n=n||E.textureOptions,v(t,r,n),n=e.shallowCopy(n);var o=d(n.src,n.crossOrigin,function(e,o){e?a(e,r,o):(z(t,r,o,n),a(null,r,o))});return o}function p(t,r,n,i){function u(e){return function(u,l){--M,u?y.push(u):l.width!==l.height?y.push("cubemap face img is not a square: "+l.src):(a(t,n),t.bindTexture(m,r),5===M?f(t).forEach(function(e){t.texImage2D(e,0,s,s,c,l)}):t.texImage2D(e,0,s,s,c,l),o(t,n),t.generateMipmap(m)),0===M&&i(y.length?y:void 0,p,r)}}i=i||h;var l=n.src;if(6!==l.length)throw"there must be 6 urls for a cubemap";var s=n.format||t.RGBA,c=n.type||t.UNSIGNED_BYTE,m=n.target||t.TEXTURE_2D;if(m!==t.TEXTURE_CUBE_MAP)throw"target must be TEXTURE_CUBE_MAP";v(t,r,n),n=e.shallowCopy(n);var p,M=6,y=[],_=f(t,n);p=l.map(function(t,e){return d(t,n.crossOrigin,u(_[e]))})}function M(t){switch(t){case F:case P:return 1;case R:return 2;case A:return 3;case T:return 4;default:throw"unknown type: "+t}}function y(e,r){return D(r)?t.getGLTypeForTypedArray(r):e.UNSIGNED_BYTE}function _(t,e,r,n,a){if(a%1!==0)throw"can't guess dimensions";if(r||n){if(n){if(!r&&(r=a/n,r%1))throw"can't guess dimensions"}else if(n=a/r,n%1)throw"can't guess dimensions"}else{var o=Math.sqrt(a/(e===t.TEXTURE_CUBE_MAP?6:1));o%1===0?(r=o,n=o):(r=a,n=1)}return{width:r,height:n}}function g(e,r,n,i){i=i||E.textureOptions;var u=i.target||e.TEXTURE_2D;e.bindTexture(u,r);var l=i.width,s=i.height,f=i.depth,h=i.format||e.RGBA,d=i.internalFormat||h,v=i.type||y(e,n),m=M(h),p=n.length/m;if(p%1)throw"length wrong size for format: "+C(e,h);var g;if(u===e.TEXTURE_3D)if(l||s||f)!l||s&&f?!s||l&&f?(g=_(e,u,l,s,p/f),l=g.width,s=g.height):(g=_(e,u,l,f,p/s),l=g.width,f=g.height):(g=_(e,u,s,f,p/l),s=g.width,f=g.height);else{var x=Math.cbrt(p);if(x%1!==0)throw"can't guess cube size of array of numElements: "+p;l=x,s=x,f=x}else g=_(e,u,l,s,p),l=g.width,s=g.height;if(D(n))n instanceof Uint8ClampedArray&&(n=new Uint8Array(n.buffer));else{var S=t.getTypedArrayTypeForGLType(v);n=new S(n)}if(e.pixelStorei(e.UNPACK_ALIGNMENT,i.unpackAlignment||1),a(e,i),u===e.TEXTURE_CUBE_MAP){var b=p/6*m;c(e,i).forEach(function(t){var r=b*t.ndx,a=n.subarray(r,r+b);e.texImage2D(t.face,0,d,l,s,0,h,v,a)})}else u===e.TEXTURE_3D?e.texImage3D(u,0,d,l,s,f,0,h,v,n):e.texImage2D(u,0,d,l,s,0,h,v,n);return o(e,i),{width:l,height:s,depth:f}}function x(t,e,r){var n=r.target||t.TEXTURE_2D;t.bindTexture(n,e);var i=r.format||t.RGBA,u=r.internalFormat||i,l=r.type||t.UNSIGNED_BYTE;if(a(t,r),n===t.TEXTURE_CUBE_MAP)for(var s=0;s<6;++s)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,u,r.width,r.height,0,i,l,null);else n===t.TEXTURE_3D?t.texImage3D(n,0,u,r.width,r.height,r.depth,0,i,l,null):t.texImage2D(n,0,u,r.width,r.height,0,i,l,null);o(t,r)}function S(t,e,r){r=r||h,e=e||E.textureOptions;var n=t.createTexture(),a=e.target||t.TEXTURE_2D,o=e.width||1,u=e.height||1;t.bindTexture(a,n),a===t.TEXTURE_CUBE_MAP&&(t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE));var l=e.src;if(l)if("function"==typeof l&&(l=l(t,e)),"string"==typeof l)m(t,n,e,r);else if(D(l)||Array.isArray(l)&&("number"==typeof l[0]||Array.isArray(l[0])||D(l[0]))){var f=g(t,n,l,e);o=f.width,u=f.height}else if(Array.isArray(l)&&"string"==typeof l[0])p(t,n,e,r);else{if(!(l instanceof HTMLElement))throw"unsupported src type";z(t,n,l,e),o=l.width,u=l.height}else x(t,n,e);return e.auto!==!1&&s(t,n,e,o,u),i(t,n,e),n}function b(t,e,r,n,a){n=n||r.width,a=a||r.height;var o=r.target||t.TEXTURE_2D;t.bindTexture(o,e);var i,u=r.format||t.RGBA,l=r.src;if(i=l&&(D(l)||Array.isArray(l)&&"number"==typeof l[0])?r.type||y(t,l):r.type||t.UNSIGNED_BYTE,o===t.TEXTURE_CUBE_MAP)for(var s=0;s<6;++s)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,u,n,a,0,u,i,null);else t.texImage2D(o,0,u,n,a,0,u,i,null)}function I(t){return"string"==typeof t||Array.isArray(t)&&"string"==typeof t[0]}function w(t,e,r){function n(){0===a&&setTimeout(function(){r(o.length?o:void 0,i,u)},0)}r=r||h;var a=0,o=[],i={},u={};return Object.keys(e).forEach(function(r){var l,s=e[r];I(s.src)&&(l=function(t,e,i){u[r]=i,--a,t&&o.push(t),n()},++a),i[r]=S(t,s,l)}),n(),i}var E={textureColor:new Uint8Array([128,192,255,255]),textureOptions:{},crossOrigin:void 0},D=t.isArrayBuffer,F=6406,A=6407,T=6408,P=6409,R=6410,C=function(){function t(t){e||(e={},Object.keys(t).forEach(function(r){"number"==typeof t[r]&&(e[t[r]]=r)}))}var e;return function(r,n){return t(),e[n]||"0x"+n.toString(16)}}(),O={},z=function(){var t=document.createElement("canvas").getContext("2d");return function(e,r,n,u){u=u||E.textureOptions;var l=u.target||e.TEXTURE_2D,f=n.width,h=n.height,d=u.format||e.RGBA,v=u.internalFormat||d,m=u.type||e.UNSIGNED_BYTE;if(a(e,u),e.bindTexture(l,r),l===e.TEXTURE_CUBE_MAP){var p,M,y=n.width,_=n.height;if(y/6===_)p=_,M=[0,0,1,0,2,0,3,0,4,0,5,0];else if(_/6===y)p=y,M=[0,0,0,1,0,2,0,3,0,4,0,5];else if(y/3===_/2)p=y/3,M=[0,0,1,0,2,0,0,1,1,1,2,1];else{if(y/2!==_/3)throw"can't figure out cube map from element: "+(n.src?n.src:n.nodeName);p=y/2,M=[0,0,1,0,0,1,1,1,0,2,1,2]}t.canvas.width=p,t.canvas.height=p,f=p,h=p,c(e,u).forEach(function(r){var a=M[2*r.ndx+0]*p,o=M[2*r.ndx+1]*p;t.drawImage(n,a,o,p,p,0,0,p,p),e.texImage2D(r.face,0,v,d,m,t.canvas)}),t.canvas.width=1,t.canvas.height=1}else if(l===e.TEXTURE_3D){var g=Math.min(n.width,n.height),x=Math.max(n.width,n.height),S=x/g;if(S%1!==0)throw"can not compute 3D dimensions of element";var b=n.width===x?1:0,I=n.height===x?1:0;e.texImage3D(l,0,v,g,g,g,0,d,m,null),t.canvas.width=g,t.canvas.height=g;for(var w=0;w<S;++w){var D=w*g*b,F=w*g*I,A=g,T=g,P=0,R=0,C=g,O=g;t.drawImage(n,D,F,A,T,P,R,C,O),e.texSubImage3D(l,0,0,0,w,d,m,t.canvas)}t.canvas.width=0,t.canvas.height=0}else e.texImage2D(l,0,v,d,m,n);o(e,u),u.auto!==!1&&s(e,r,u,f,h),i(e,r,u)}}();return{setDefaults_:n,createTexture:S,setEmptyTexture:x,setTextureFromArray:g,loadTextureFromUrl:m,setTextureFromElement:z,setTextureFilteringForSize:s,setTextureParameters:i,setDefaultTextureColor:r,createTextures:w,resizeTexture:b,getNumComponentsForFormat:M}}),r("twgl/framebuffers",["./textures","./utils"],function(t,e){function r(t){return I[t]}function n(t){return w[t]}function a(a,o,i,u){var l=a.FRAMEBUFFER,s=a.createFramebuffer();a.bindFramebuffer(l,s),i=i||a.drawingBufferWidth,u=u||a.drawingBufferHeight,o=o||b;var f=0,c={framebuffer:s,attachments:[],width:i,height:u};return o.forEach(function(o){var s=o.attachment,h=o.format,d=r(h);if(d||(d=M+f++),!s)if(n(h))s=a.createRenderbuffer(),a.bindRenderbuffer(a.RENDERBUFFER,s),a.renderbufferStorage(a.RENDERBUFFER,h,i,u);else{var v=e.shallowCopy(o);v.width=i,v.height=u,v.auto=void 0!==o.auto&&o.auto,s=t.createTexture(a,v)}if(s instanceof WebGLRenderbuffer)a.framebufferRenderbuffer(l,d,a.RENDERBUFFER,s);else{if(!(s instanceof WebGLTexture))throw"unknown attachment type";a.framebufferTexture2D(l,d,o.texTarget||a.TEXTURE_2D,s,o.level||0)}c.attachments.push(s)}),c}function o(e,r,n,a,o){a=a||e.drawingBufferWidth,o=o||e.drawingBufferHeight,r.width=a,r.height=o,n=n||b,n.forEach(function(n,i){var u=r.attachments[i],l=n.format;if(u instanceof WebGLRenderbuffer)e.bindRenderbuffer(e.RENDERBUFFER,u),e.renderbufferStorage(e.RENDERBUFFER,l,a,o);else{if(!(u instanceof WebGLTexture))throw"unknown attachment type";t.resizeTexture(e,u,n,a,o)}})}function i(t,e,r){r=r||t.FRAMEBUFFER,e?(t.bindFramebuffer(r,e.framebuffer),t.viewport(0,0,e.width,e.height)):(t.bindFramebuffer(r,null),t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight))}var u=5121,l=6402,s=6408,f=32854,c=32855,h=36194,d=33189,v=6401,m=36168,p=34041,M=36064,y=36096,_=36128,g=33306,x=33071,S=9729,b=[{format:s,type:u,min:S,wrap:x},{format:p}],I={};I[p]=g,I[v]=_,I[m]=_,I[l]=y,I[d]=y;var w={};return w[f]=!0,w[c]=!0,w[h]=!0,w[p]=!0,w[d]=!0,w[v]=!0,w[m]=!0,{bindFramebufferInfo:i,createFramebufferInfo:a,resizeFramebufferInfo:o}}),r("twgl/twgl",["./attributes","./draw","./framebuffers","./programs","./textures","./typedarrays","./utils"],function(t,e,r,n,a,o,i){function u(e){i.copyExistingProperties(e,p),t.setDefaults_(e),a.setDefaults_(e)}function l(t){if(t&&p.enableVertexArrayObjects&&i.isWebGL1(t)){var e=t.getExtension("OES_vertex_array_object");e&&(t.createVertexArray=function(){return e.createVertexArrayOES()},t.deleteVertexArray=function(t){e.deleteVertexArrayOES(t)},t.isVertexArray=function(t){return e.isVertexArrayOES(t)},t.bindVertexArray=function(t){e.bindVertexArrayOES(t)},t.VERTEX_ARRAY_BINDING=e.VERTEX_ARRAY_BINDING_OES)}}function s(t,e){for(var r=["webgl","experimental-webgl"],n=null,a=0;a<r.length;++a){try{n=t.getContext(r[a],e)}catch(o){}if(n)break}return n}function f(t,e){var r=s(t,e);return l(r),r}function c(t,e){for(var r=["webgl2","experimental-webgl2","webgl","experimental-webgl"],n=null,a=0;a<r.length;++a){try{n=t.getContext(r[a],e)}catch(o){}if(n)break}return n}function h(t,e){var r=c(t,e);return l(r),r}function d(t,e){e=e||1,e=Math.max(1,e);var r=t.clientWidth*e|0,n=t.clientHeight*e|0;return(t.width!==r||t.height!==n)&&(t.width=r,t.height=n,!0)}function v(t){return"_"!==t[t.length-1]}function m(t,e){return Object.keys(t).filter(v).forEach(function(r){e[r]=t[r]}),e}var p={enableVertexArrayObjects:!0},M={getContext:h,getWebGLContext:f,isWebGL1:i.isWebGL1,isWebGL2:i.isWebGL2,resizeCanvasToDisplaySize:d,setDefaults:u},y={attributes:t,draw:e,framebuffers:r,programs:n,textures:a,typedArrays:o};return Object.keys(y).forEach(function(t){var e=y[t];m(e,M),M[t]=m(e,{})}),M}),r("twgl/v3",[],function(){function t(t){var e=p;return p=t,e}function e(t,e,r){var n=new p(3);return t&&(n[0]=t),e&&(n[1]=e),r&&(n[2]=r),n}function r(t,e,r){return r=r||new p(3),r[0]=t[0]+e[0],r[1]=t[1]+e[1],r[2]=t[2]+e[2],r}function n(t,e,r){return r=r||new p(3),r[0]=t[0]-e[0],r[1]=t[1]-e[1],r[2]=t[2]-e[2],r}function a(t,e,r,n){return n=n||new p(3),n[0]=(1-r)*t[0]+r*e[0],n[1]=(1-r)*t[1]+r*e[1],n[2]=(1-r)*t[2]+r*e[2],n}function o(t,e,r){return r=r||new p(3),r[0]=t[0]*e,r[1]=t[1]*e,r[2]=t[2]*e,r}function i(t,e,r){return r=r||new p(3),r[0]=t[0]/e,r[1]=t[1]/e,r[2]=t[2]/e,r}function u(t,e,r){return r=r||new p(3),r[0]=t[1]*e[2]-t[2]*e[1],r[1]=t[2]*e[0]-t[0]*e[2],r[2]=t[0]*e[1]-t[1]*e[0],r}function l(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function s(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2])}function f(t){return t[0]*t[0]+t[1]*t[1]+t[2]*t[2]}function c(t,e){e=e||new p(3);var r=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=Math.sqrt(r);return n>1e-5?(e[0]=t[0]/n,e[1]=t[1]/n,e[2]=t[2]/n):(e[0]=0,e[1]=0,e[2]=0),e}function h(t,e){return e=e||new p(3),e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function d(t,e){return e=e||new p(3),e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function v(t,e,r){return r=r||new p(3),r[0]=t[0]*e[0],r[1]=t[1]*e[1],r[2]=t[2]*e[2],r}function m(t,e,r){return r=r||new p(3),r[0]=t[0]/e[0],r[1]=t[1]/e[1],r[2]=t[2]/e[2],r}var p=Float32Array;return{add:r,copy:d,create:e,cross:u,divide:m,divScalar:i,dot:l,lerp:a,length:s,lengthSq:f,mulScalar:o,multiply:v,
negate:h,normalize:c,setDefaultType:t,subtract:n}}),r("twgl/m4",["./v3"],function(t){function e(t){var e=P;return P=t,e}function r(t,e){return e=e||new P(16),e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=-t[7],e[8]=-t[8],e[9]=-t[9],e[10]=-t[10],e[11]=-t[11],e[12]=-t[12],e[13]=-t[13],e[14]=-t[14],e[15]=-t[15],e}function n(t,e){return e=e||new P(16),e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function a(t){return t=t||new P(16),t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function o(t,e){if(e=e||new P(16),e===t){var r;return r=t[1],t[1]=t[4],t[4]=r,r=t[2],t[2]=t[8],t[8]=r,r=t[3],t[3]=t[12],t[12]=r,r=t[6],t[6]=t[9],t[9]=r,r=t[7],t[7]=t[13],t[13]=r,r=t[11],t[11]=t[14],t[14]=r,e}var n=t[0],a=t[1],o=t[2],i=t[3],u=t[4],l=t[5],s=t[6],f=t[7],c=t[8],h=t[9],d=t[10],v=t[11],m=t[12],p=t[13],M=t[14],y=t[15];return e[0]=n,e[1]=u,e[2]=c,e[3]=m,e[4]=a,e[5]=l,e[6]=h,e[7]=p,e[8]=o,e[9]=s,e[10]=d,e[11]=M,e[12]=i,e[13]=f,e[14]=v,e[15]=y,e}function i(t,e){e=e||new P(16);var r=t[0],n=t[1],a=t[2],o=t[3],i=t[4],u=t[5],l=t[6],s=t[7],f=t[8],c=t[9],h=t[10],d=t[11],v=t[12],m=t[13],p=t[14],M=t[15],y=h*M,_=p*d,g=l*M,x=p*s,S=l*d,b=h*s,I=a*M,w=p*o,E=a*d,D=h*o,F=a*s,A=l*o,T=f*m,R=v*c,C=i*m,O=v*u,z=i*c,k=f*u,U=r*m,N=v*n,L=r*c,B=f*n,V=r*u,q=i*n,j=y*u+x*c+S*m-(_*u+g*c+b*m),Y=_*n+I*c+D*m-(y*n+w*c+E*m),G=g*n+w*u+F*m-(x*n+I*u+A*m),X=b*n+E*u+A*c-(S*n+D*u+F*c),W=1/(r*j+i*Y+f*G+v*X);return e[0]=W*j,e[1]=W*Y,e[2]=W*G,e[3]=W*X,e[4]=W*(_*i+g*f+b*v-(y*i+x*f+S*v)),e[5]=W*(y*r+w*f+E*v-(_*r+I*f+D*v)),e[6]=W*(x*r+I*i+A*v-(g*r+w*i+F*v)),e[7]=W*(S*r+D*i+F*f-(b*r+E*i+A*f)),e[8]=W*(T*s+O*d+z*M-(R*s+C*d+k*M)),e[9]=W*(R*o+U*d+B*M-(T*o+N*d+L*M)),e[10]=W*(C*o+N*s+V*M-(O*o+U*s+q*M)),e[11]=W*(k*o+L*s+q*d-(z*o+B*s+V*d)),e[12]=W*(C*h+k*p+R*l-(z*p+T*l+O*h)),e[13]=W*(L*p+T*a+N*h-(U*h+B*p+R*a)),e[14]=W*(U*l+q*p+O*a-(V*p+C*a+N*l)),e[15]=W*(V*h+z*a+B*l-(L*l+q*h+k*a)),e}function u(t,e,r){r=r||new P(16);var n=t[0],a=t[1],o=t[2],i=t[3],u=t[4],l=t[5],s=t[6],f=t[7],c=t[8],h=t[9],d=t[10],v=t[11],m=t[12],p=t[13],M=t[14],y=t[15],_=e[0],g=e[1],x=e[2],S=e[3],b=e[4],I=e[5],w=e[6],E=e[7],D=e[8],F=e[9],A=e[10],T=e[11],R=e[12],C=e[13],O=e[14],z=e[15];return r[0]=n*_+a*b+o*D+i*R,r[1]=n*g+a*I+o*F+i*C,r[2]=n*x+a*w+o*A+i*O,r[3]=n*S+a*E+o*T+i*z,r[4]=u*_+l*b+s*D+f*R,r[5]=u*g+l*I+s*F+f*C,r[6]=u*x+l*w+s*A+f*O,r[7]=u*S+l*E+s*T+f*z,r[8]=c*_+h*b+d*D+v*R,r[9]=c*g+h*I+d*F+v*C,r[10]=c*x+h*w+d*A+v*O,r[11]=c*S+h*E+d*T+v*z,r[12]=m*_+p*b+M*D+y*R,r[13]=m*g+p*I+M*F+y*C,r[14]=m*x+p*w+M*A+y*O,r[15]=m*S+p*E+M*T+y*z,r}function l(t,e,r){return r=r||a(),t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11]),r[12]=e[0],r[13]=e[1],r[14]=e[2],r[15]=1,r}function s(e,r){return r=r||t.create(),r[0]=e[12],r[1]=e[13],r[2]=e[14],r}function f(e,r,n){n=n||t.create();var a=4*r;return n[0]=e[a+0],n[1]=e[a+1],n[2]=e[a+2],n}function c(t,e,r,a){a!==t&&(a=n(t,a));var o=4*r;return a[o+0]=e[0],a[o+1]=e[1],a[o+2]=e[2],a}function h(t,e,r,n,a){a=a||new P(16);var o=Math.tan(.5*Math.PI-.5*t),i=1/(r-n);return a[0]=o/e,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=o,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=(r+n)*i,a[11]=-1,a[12]=0,a[13]=0,a[14]=r*n*i*2,a[15]=0,a}function d(t,e,r,n,a,o,i){return i=i||new P(16),i[0]=2/(e-t),i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2/(n-r),i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=-1/(o-a),i[11]=0,i[12]=(e+t)/(t-e),i[13]=(n+r)/(r-n),i[14]=-a/(a-o),i[15]=1,i}function v(t,e,r,n,a,o,i){i=i||new P(16);var u=e-t,l=n-r,s=a-o;return i[0]=2*a/u,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2*a/l,i[6]=0,i[7]=0,i[8]=(t+e)/u,i[9]=(n+r)/l,i[10]=o/s,i[11]=-1,i[12]=0,i[13]=0,i[14]=a*o/s,i[15]=0,i}function m(e,r,n,a){a=a||new P(16);var o=R,i=C,u=O;return t.normalize(t.subtract(e,r,u),u),t.normalize(t.cross(n,u,o),o),t.normalize(t.cross(u,o,i),i),a[0]=o[0],a[1]=o[1],a[2]=o[2],a[3]=0,a[4]=i[0],a[5]=i[1],a[6]=i[2],a[7]=0,a[8]=u[0],a[9]=u[1],a[10]=u[2],a[11]=0,a[12]=e[0],a[13]=e[1],a[14]=e[2],a[15]=1,a}function p(t,e){return e=e||new P(16),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function M(t,e,r){r=r||new P(16);var n=e[0],a=e[1],o=e[2],i=t[0],u=t[1],l=t[2],s=t[3],f=t[4],c=t[5],h=t[6],d=t[7],v=t[8],m=t[9],p=t[10],M=t[11],y=t[12],_=t[13],g=t[14],x=t[15];return t!==r&&(r[0]=i,r[1]=u,r[2]=l,r[3]=s,r[4]=f,r[5]=c,r[6]=h,r[7]=d,r[8]=v,r[9]=m,r[10]=p,r[11]=M),r[12]=i*n+f*a+v*o+y,r[13]=u*n+c*a+m*o+_,r[14]=l*n+h*a+p*o+g,r[15]=s*n+d*a+M*o+x,r}function y(t,e){e=e||new P(16);var r=Math.cos(t),n=Math.sin(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function _(t,e,r){r=r||new P(16);var n=t[4],a=t[5],o=t[6],i=t[7],u=t[8],l=t[9],s=t[10],f=t[11],c=Math.cos(e),h=Math.sin(e);return r[4]=c*n+h*u,r[5]=c*a+h*l,r[6]=c*o+h*s,r[7]=c*i+h*f,r[8]=c*u-h*n,r[9]=c*l-h*a,r[10]=c*s-h*o,r[11]=c*f-h*i,t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r}function g(t,e){e=e||new P(16);var r=Math.cos(t),n=Math.sin(t);return e[0]=r,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function x(t,e,r){r=r||new P(16);var n=t[0],a=t[1],o=t[2],i=t[3],u=t[8],l=t[9],s=t[10],f=t[11],c=Math.cos(e),h=Math.sin(e);return r[0]=c*n-h*u,r[1]=c*a-h*l,r[2]=c*o-h*s,r[3]=c*i-h*f,r[8]=c*u+h*n,r[9]=c*l+h*a,r[10]=c*s+h*o,r[11]=c*f+h*i,t!==r&&(r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r}function S(t,e){e=e||new P(16);var r=Math.cos(t),n=Math.sin(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function b(t,e,r){r=r||new P(16);var n=t[0],a=t[1],o=t[2],i=t[3],u=t[4],l=t[5],s=t[6],f=t[7],c=Math.cos(e),h=Math.sin(e);return r[0]=c*n+h*u,r[1]=c*a+h*l,r[2]=c*o+h*s,r[3]=c*i+h*f,r[4]=c*u-h*n,r[5]=c*l-h*a,r[6]=c*s-h*o,r[7]=c*f-h*i,t!==r&&(r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r}function I(t,e,r){r=r||new P(16);var n=t[0],a=t[1],o=t[2],i=Math.sqrt(n*n+a*a+o*o);n/=i,a/=i,o/=i;var u=n*n,l=a*a,s=o*o,f=Math.cos(e),c=Math.sin(e),h=1-f;return r[0]=u+(1-u)*f,r[1]=n*a*h+o*c,r[2]=n*o*h-a*c,r[3]=0,r[4]=n*a*h-o*c,r[5]=l+(1-l)*f,r[6]=a*o*h+n*c,r[7]=0,r[8]=n*o*h+a*c,r[9]=a*o*h-n*c,r[10]=s+(1-s)*f,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function w(t,e,r,n){n=n||new P(16);var a=e[0],o=e[1],i=e[2],u=Math.sqrt(a*a+o*o+i*i);a/=u,o/=u,i/=u;var l=a*a,s=o*o,f=i*i,c=Math.cos(r),h=Math.sin(r),d=1-c,v=l+(1-l)*c,m=a*o*d+i*h,p=a*i*d-o*h,M=a*o*d-i*h,y=s+(1-s)*c,_=o*i*d+a*h,g=a*i*d+o*h,x=o*i*d-a*h,S=f+(1-f)*c,b=t[0],I=t[1],w=t[2],E=t[3],D=t[4],F=t[5],A=t[6],T=t[7],R=t[8],C=t[9],O=t[10],z=t[11];return n[0]=v*b+m*D+p*R,n[1]=v*I+m*F+p*C,n[2]=v*w+m*A+p*O,n[3]=v*E+m*T+p*z,n[4]=M*b+y*D+_*R,n[5]=M*I+y*F+_*C,n[6]=M*w+y*A+_*O,n[7]=M*E+y*T+_*z,n[8]=g*b+x*D+S*R,n[9]=g*I+x*F+S*C,n[10]=g*w+x*A+S*O,n[11]=g*E+x*T+S*z,t!==n&&(n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n}function E(t,e){return e=e||new P(16),e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function D(t,e,r){r=r||new P(16);var n=e[0],a=e[1],o=e[2];return r[0]=n*t[0],r[1]=n*t[1],r[2]=n*t[2],r[3]=n*t[3],r[4]=a*t[4],r[5]=a*t[5],r[6]=a*t[6],r[7]=a*t[7],r[8]=o*t[8],r[9]=o*t[9],r[10]=o*t[10],r[11]=o*t[11],t!==r&&(r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r}function F(e,r,n){n=n||t.create();var a=r[0],o=r[1],i=r[2],u=a*e[3]+o*e[7]+i*e[11]+e[15];return n[0]=(a*e[0]+o*e[4]+i*e[8]+e[12])/u,n[1]=(a*e[1]+o*e[5]+i*e[9]+e[13])/u,n[2]=(a*e[2]+o*e[6]+i*e[10]+e[14])/u,n}function A(e,r,n){n=n||t.create();var a=r[0],o=r[1],i=r[2];return n[0]=a*e[0]+o*e[4]+i*e[8],n[1]=a*e[1]+o*e[5]+i*e[9],n[2]=a*e[2]+o*e[6]+i*e[10],n}function T(e,r,n){n=n||t.create();var a=i(e),o=r[0],u=r[1],l=r[2];return n[0]=o*a[0]+u*a[1]+l*a[2],n[1]=o*a[4]+u*a[5]+l*a[6],n[2]=o*a[8]+u*a[9]+l*a[10],n}var P=Float32Array,R=t.create(),C=t.create(),O=t.create();return{axisRotate:w,axisRotation:I,create:a,copy:n,frustum:v,getAxis:f,getTranslation:s,identity:a,inverse:i,lookAt:m,multiply:u,negate:r,ortho:d,perspective:h,rotateX:_,rotateY:x,rotateZ:b,rotateAxis:w,rotationX:y,rotationY:g,rotationZ:S,scale:D,scaling:E,setAxis:c,setDefaultType:e,setTranslation:l,transformDirection:A,transformNormal:T,transformPoint:F,translate:M,translation:p,transpose:o}}),r("twgl/primitives",["./attributes","./twgl","./utils","./m4","./v3"],function(t,e,r,n,a){function o(t,e){var r=0;return t.push=function(){for(var e=0;e<arguments.length;++e){var n=arguments[e];if(n instanceof Array||n.buffer&&n.buffer instanceof ArrayBuffer)for(var a=0;a<n.length;++a)t[r++]=n[a];else t[r++]=n}},t.reset=function(t){r=t||0},t.numComponents=e,Object.defineProperty(t,"numElements",{get:function(){return this.length/this.numComponents|0}}),t}function i(t,e,r){var n=r||Float32Array;return o(new n(t*e),t)}function u(t){return"indices"!==t}function l(t){function e(e){for(var o=t[e],u=o.numComponents,l=i(u,a,o.constructor),s=0;s<a;++s)for(var f=r[s],c=f*u,h=0;h<u;++h)l.push(o[c+h]);n[e]=l}var r=t.indices,n={},a=r.length;return Object.keys(t).filter(u).forEach(e),n}function s(t){if(t.indices)throw"can't flatten normals of indexed vertices. deindex them first";for(var e=t.normal,r=e.length,n=0;n<r;n+=9){var a=e[n+0],o=e[n+1],i=e[n+2],u=e[n+3],l=e[n+4],s=e[n+5],f=e[n+6],c=e[n+7],h=e[n+8],d=a+u+f,v=o+l+c,m=i+s+h,p=Math.sqrt(d*d+v*v+m*m);d/=p,v/=p,m/=p,e[n+0]=d,e[n+1]=v,e[n+2]=m,e[n+3]=d,e[n+4]=v,e[n+5]=m,e[n+6]=d,e[n+7]=v,e[n+8]=m}return t}function f(t,e,r){for(var n=t.length,a=new Float32Array(3),o=0;o<n;o+=3)r(e,[t[o],t[o+1],t[o+2]],a),t[o]=a[0],t[o+1]=a[1],t[o+2]=a[2]}function c(t,e,r){r=r||a.create();var n=e[0],o=e[1],i=e[2];return r[0]=n*t[0]+o*t[1]+i*t[2],r[1]=n*t[4]+o*t[5]+i*t[6],r[2]=n*t[8]+o*t[9]+i*t[10],r}function h(t,e){return f(t,e,n.transformDirection),t}function d(t,e){return f(t,n.inverse(e),c),t}function v(t,e){return f(t,e,n.transformPoint),t}function m(t,e){return Object.keys(t).forEach(function(r){var n=t[r];r.indexOf("pos")>=0?v(n,e):r.indexOf("tan")>=0||r.indexOf("binorm")>=0?h(n,e):r.indexOf("norm")>=0&&d(n,e)}),t}function p(t,e,r){return t=t||2,e=e||0,r=r||0,t*=.5,{position:{numComponents:2,data:[e+-1*t,r+-1*t,e+1*t,r+-1*t,e+-1*t,r+1*t,e+1*t,r+1*t]},normal:[0,0,1,0,0,1,0,0,1,0,0,1],texcoord:[0,0,1,0,0,1,1,1],indices:[0,1,2,2,1,3]}}function M(t,e,r,a,o){t=t||1,e=e||1,r=r||1,a=a||1,o=o||n.identity();for(var u=(r+1)*(a+1),l=i(3,u),s=i(3,u),f=i(2,u),c=0;c<=a;c++)for(var h=0;h<=r;h++){var d=h/r,v=c/a;l.push(t*d-.5*t,0,e*v-.5*e),s.push(0,1,0),f.push(d,v)}for(var p=r+1,M=i(3,r*a*2,Uint16Array),c=0;c<a;c++)for(var h=0;h<r;h++)M.push((c+0)*p+h,(c+1)*p+h,(c+0)*p+h+1),M.push((c+1)*p+h,(c+1)*p+h+1,(c+0)*p+h+1);var y=m({position:l,normal:s,texcoord:f,indices:M},o);return y}function y(t,e,r,n,a,o,u){if(e<=0||r<=0)throw Error("subdivisionAxis and subdivisionHeight must be > 0");n=n||0,a=a||Math.PI,o=o||0,u=u||2*Math.PI;for(var l=a-n,s=u-o,f=(e+1)*(r+1),c=i(3,f),h=i(3,f),d=i(2,f),v=0;v<=r;v++)for(var m=0;m<=e;m++){var p=m/e,M=v/r,y=s*p,_=l*M,g=Math.sin(y),x=Math.cos(y),S=Math.sin(_),b=Math.cos(_),I=x*S,w=b,E=g*S;c.push(t*I,t*w,t*E),h.push(I,w,E),d.push(1-p,M)}for(var D=e+1,F=i(3,e*r*2,Uint16Array),m=0;m<e;m++)for(var v=0;v<r;v++)F.push((v+0)*D+m,(v+0)*D+m+1,(v+1)*D+m),F.push((v+1)*D+m,(v+0)*D+m+1,(v+1)*D+m+1);return{position:c,normal:h,texcoord:d,indices:F}}function _(t){t=t||1;for(var e=t/2,r=[[-e,-e,-e],[+e,-e,-e],[-e,+e,-e],[+e,+e,-e],[-e,-e,+e],[+e,-e,+e],[-e,+e,+e],[+e,+e,+e]],n=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],a=[[1,0],[0,0],[0,1],[1,1]],o=24,u=i(3,o),l=i(3,o),s=i(2,o),f=i(3,12,Uint16Array),c=0;c<6;++c){for(var h=U[c],d=0;d<4;++d){var v=r[h[d]],m=n[c],p=a[d];u.push(v),l.push(m),s.push(p)}var M=4*c;f.push(M+0,M+1,M+2),f.push(M+0,M+2,M+3)}return{position:u,normal:l,texcoord:s,indices:f}}function g(t,e,r,n,a,o,u){if(n<3)throw Error("radialSubdivisions must be 3 or greater");if(a<1)throw Error("verticalSubdivisions must be 1 or greater");for(var l=void 0===o||o,s=void 0===u||u,f=(l?2:0)+(s?2:0),c=(n+1)*(a+1+f),h=i(3,c),d=i(3,c),v=i(2,c),m=i(3,n*(a+f)*2,Uint16Array),p=n+1,M=Math.atan2(t-e,r),y=Math.cos(M),_=Math.sin(M),g=l?-2:0,x=a+(s?2:0),S=g;S<=x;++S){var b,I=S/a,w=r*I;S<0?(w=0,I=1,b=t):S>a?(w=r,I=1,b=e):b=t+(e-t)*(S/a),S!==-2&&S!==a+2||(b=0,I=0),w-=r/2;for(var E=0;E<p;++E){var D=Math.sin(E*Math.PI*2/n),F=Math.cos(E*Math.PI*2/n);h.push(D*b,w,F*b),d.push(S<0||S>a?0:D*y,S<0?-1:S>a?1:_,S<0||S>a?0:F*y),v.push(E/n,1-I)}}for(var S=0;S<a+f;++S)for(var E=0;E<n;++E)m.push(p*(S+0)+0+E,p*(S+0)+1+E,p*(S+1)+1+E),m.push(p*(S+0)+0+E,p*(S+1)+1+E,p*(S+1)+0+E);return{position:h,normal:d,texcoord:v,indices:m}}function x(t,e){e=e||[];for(var r=[],n=0;n<t.length;n+=4){var a=t[n],o=t.slice(n+1,n+4);o.push.apply(o,e);for(var i=0;i<a;++i)r.push.apply(r,o)}return r}function S(){var t=[0,0,0,0,150,0,30,0,0,0,150,0,30,150,0,30,0,0,30,0,0,30,30,0,100,0,0,30,30,0,100,30,0,100,0,0,30,60,0,30,90,0,67,60,0,30,90,0,67,90,0,67,60,0,0,0,30,30,0,30,0,150,30,0,150,30,30,0,30,30,150,30,30,0,30,100,0,30,30,30,30,30,30,30,100,0,30,100,30,30,30,60,30,67,60,30,30,90,30,30,90,30,67,60,30,67,90,30,0,0,0,100,0,0,100,0,30,0,0,0,100,0,30,0,0,30,100,0,0,100,30,0,100,30,30,100,0,0,100,30,30,100,0,30,30,30,0,30,30,30,100,30,30,30,30,0,100,30,30,100,30,0,30,30,0,30,60,30,30,30,30,30,30,0,30,60,0,30,60,30,30,60,0,67,60,30,30,60,30,30,60,0,67,60,0,67,60,30,67,60,0,67,90,30,67,60,30,67,60,0,67,90,0,67,90,30,30,90,0,30,90,30,67,90,30,30,90,0,67,90,30,67,90,0,30,90,0,30,150,30,30,90,30,30,90,0,30,150,0,30,150,30,0,150,0,0,150,30,30,150,30,0,150,0,30,150,30,30,150,0,0,0,0,0,0,30,0,150,30,0,0,0,0,150,30,0,150,0],e=[.22,.19,.22,.79,.34,.19,.22,.79,.34,.79,.34,.19,.34,.19,.34,.31,.62,.19,.34,.31,.62,.31,.62,.19,.34,.43,.34,.55,.49,.43,.34,.55,.49,.55,.49,.43,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0],r=x([18,0,0,1,18,0,0,-1,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,-1,0,6,-1,0,0]),n=x([18,200,70,120,18,80,70,200,6,70,200,210,6,200,200,70,6,210,100,70,6,210,160,70,6,70,180,210,6,100,70,210,6,76,210,100,6,140,210,80,6,90,130,110,6,160,160,220],[255]),a=t.length/3,o={position:i(3,a),texcoord:i(2,a),normal:i(3,a),color:i(4,a,Uint8Array),indices:i(3,a/3,Uint16Array)};o.position.push(t),o.texcoord.push(e),o.normal.push(r),o.color.push(n);for(var u=0;u<a;++u)o.indices.push(u);return o}function b(t,e,r,n,o,u,l){function s(t,e,r){return t+(e-t)*r}function f(e,r,i,l,f,c){for(var v=0;v<=o;v++){var y=r/(h-1),_=v/o,g=2*(y-.5),x=(u+_*d)*Math.PI,S=Math.sin(x),b=Math.cos(x),I=s(t,e,S),w=g*n,E=b*t,D=S*I;m.push(w,E,D);var F=a.add(a.multiply([0,S,b],i),l);p.push(F),M.push(y*f+c,_)}}function c(t,e){for(var r=0;r<o;++r)g.push(t+r+0,t+r+1,e+r+0),g.push(t+r+1,e+r+1,e+r+0)}if(o<=0)throw Error("subdivisionDown must be > 0");u=u||0,l=l||1;for(var h=2,d=l-u,v=2*(o+1)*(2+h),m=i(3,v),p=i(3,v),M=i(2,v),y=0;y<h;y++){var _=2*(y/(h-1)-.5);f(e,y,[1,1,1],[0,0,0],1,0),f(e,y,[0,0,0],[_,0,0],0,0),f(r,y,[1,1,1],[0,0,0],1,0),f(r,y,[0,0,0],[_,0,0],0,1)}var g=i(3,2*o*(2+h),Uint16Array),x=o+1;return c(0*x,4*x),c(5*x,7*x),c(6*x,2*x),c(3*x,1*x),{position:m,normal:p,texcoord:M,indices:g}}function I(t,e,r,n,a,o){return g(t,t,e,r,n,a,o)}function w(t,e,r,n,a,o){if(r<3)throw Error("radialSubdivisions must be 3 or greater");if(n<3)throw Error("verticalSubdivisions must be 3 or greater");a=a||0,o=o||2*Math.PI,range=o-a;for(var u=r+1,l=n+1,s=u*l,f=i(3,s),c=i(3,s),h=i(2,s),d=i(3,r*n*2,Uint16Array),v=0;v<l;++v)for(var m=v/n,p=m*Math.PI*2,M=Math.sin(p),y=t+M*e,_=Math.cos(p),g=_*e,x=0;x<u;++x){var S=x/r,b=a+S*range,I=Math.sin(b),w=Math.cos(b),E=I*y,D=w*y,F=I*M,A=w*M;f.push(E,g,D),c.push(F,_,A),h.push(S,1-m)}for(var v=0;v<n;++v)for(var x=0;x<r;++x){var T=1+x,P=1+v;d.push(u*v+x,u*P+x,u*v+T),d.push(u*P+x,u*P+T,u*v+T)}return{position:f,normal:c,texcoord:h,indices:d}}function E(t,e,r,n,a){if(e<3)throw Error("divisions must be at least 3");r=r?r:1,a=a?a:1,n=n?n:0;for(var o=(e+1)*(r+1),u=i(3,o),l=i(3,o),s=i(2,o),f=i(3,r*e*2,Uint16Array),c=0,h=t-n,d=e+1,v=0;v<=r;++v){for(var m=n+h*Math.pow(v/r,a),p=0;p<=e;++p){var M=2*Math.PI*p/e,y=m*Math.cos(M),_=m*Math.sin(M);if(u.push(y,0,_),l.push(0,1,0),s.push(1-p/e,v/r),v>0&&p!==e){var g=c+(p+1),x=c+p,S=c+p-d,b=c+(p+1)-d;f.push(g,x,S),f.push(g,S,b)}}c+=e+1}return{position:u,normal:l,texcoord:s,indices:f}}function D(t){return Math.random()*t|0}function F(t,e){e=e||{};var r=t.position.numElements,n=i(4,r,Uint8Array),a=e.rand||function(t,e){return e<3?D(256):255};if(t.color=n,t.indices)for(var o=0;o<r;++o)n.push(a(o,0),a(o,1),a(o,2),a(o,3));else for(var u=e.vertsPerColor||3,l=r/u,o=0;o<l;++o)for(var s=[a(o,0),a(o,1),a(o,2),a(o,3)],f=0;f<u;++f)n.push(s);return t}function A(t){return function(r){var n=t.apply(this,Array.prototype.slice.call(arguments,1));return e.createBuffersFromArrays(r,n)}}function T(t){return function(r){var n=t.apply(null,Array.prototype.slice.call(arguments,1));return e.createBufferInfoFromArrays(r,n)}}function P(t,e,r,n){n=n||0;for(var a=t.length,o=0;o<a;++o)e[r+o]=t[o]+n}function R(t,e){var n=z(t),a=new n.constructor(e),i=a;return n.numComponents&&n.numElements&&o(a,n.numComponents),t.data&&(i={data:a},r.copyNamedProperties(N,t,i)),i}function C(t){function e(e){for(var r,n=0,a=0;a<t.length;++a){var o=t[a],i=o[e],u=z(i);n+=u.length,r&&!i.data||(r=i)}return{length:n,spec:r}}function r(e,r,n){for(var a=0,o=0,i=0;i<t.length;++i){var u=t[i],l=u[e],s=z(l);"indices"===e?(P(s,n,o,a),a+=r[i]):P(s,n,o),o+=s.length}}for(var n,a={},o=0;o<t.length;++o){var i=t[o];Object.keys(i).forEach(function(t){a[t]||(a[t]=[]),n||"indices"===t||(n=t);var e=i[t],r=k(e,t),o=z(e),u=o.length/r;a[t].push(u)})}var u=a[n],l={};return Object.keys(a).forEach(function(t){var n=e(t),a=R(n.spec,n.length);r(t,u,z(a)),l[t]=a}),l}function O(t){var e={};return Object.keys(t).forEach(function(r){var n=t[r],a=z(n),o=R(n,a.length);P(a,z(o),0),e[r]=o}),e}var z=t.getArray_,k=t.getNumComponents_,U=[[3,7,5,1],[6,2,0,4],[6,7,3,2],[0,1,5,4],[7,6,4,5],[2,3,1,0]],N=["numComponents","size","type","normalize","stride","offset","attrib","name","attribName"];return{create3DFBufferInfo:T(S),create3DFBuffers:A(S),create3DFVertices:S,createAugmentedTypedArray:i,createCubeBufferInfo:T(_),createCubeBuffers:A(_),createCubeVertices:_,createPlaneBufferInfo:T(M),createPlaneBuffers:A(M),createPlaneVertices:M,createSphereBufferInfo:T(y),createSphereBuffers:A(y),createSphereVertices:y,createTruncatedConeBufferInfo:T(g),createTruncatedConeBuffers:A(g),createTruncatedConeVertices:g,createXYQuadBufferInfo:T(p),createXYQuadBuffers:A(p),createXYQuadVertices:p,createCresentBufferInfo:T(b),createCresentBuffers:A(b),createCresentVertices:b,createCylinderBufferInfo:T(I),createCylinderBuffers:A(I),createCylinderVertices:I,createTorusBufferInfo:T(w),createTorusBuffers:A(w),createTorusVertices:w,createDiscBufferInfo:T(E),createDiscBuffers:A(E),createDiscVertices:E,deindexVertices:l,flattenNormals:s,makeRandomVertexColors:F,reorientDirections:h,reorientNormals:d,reorientPositions:v,reorientVertices:m,concatVertices:C,duplicateVertices:O}}),r("main",["twgl/twgl","twgl/m4","twgl/v3","twgl/primitives"],function(t,e,r,n){return t.m4=e,t.v3=r,t.primitives=n,t}),e(["main"],function(t){return t},void 0,!0),r("build/js/twgl-includer-full",function(){}),e("main")})},function(t,e){var r={};r.EPSILON=1e-6,r.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,r.RANDOM=Math.random,r.ENABLE_SIMD=!1,r.SIMD_AVAILABLE=r.ARRAY_TYPE===Float32Array&&"SIMD"in this,r.USE_SIMD=r.ENABLE_SIMD&&r.SIMD_AVAILABLE,r.setMatrixArrayType=function(t){r.ARRAY_TYPE=t};var n=Math.PI/180;r.toRadian=function(t){return t*n},r.equals=function(t,e){return Math.abs(t-e)<=r.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},t.exports=r},function(t,e){t.exports="precision mediump float;\n\nvarying vec4 v_position;\nvarying vec2 v_texCoord;\nvarying vec3 v_normal;\nvarying vec3 v_surfaceToView;\nvarying float v_distance;\n\nuniform vec3 u_lightWorld;\nuniform vec4 u_lightColor;\nuniform vec4 u_ambient;\nuniform vec4 u_diffuse;\nuniform vec4 u_specular;\nuniform float u_shininess;\nuniform float u_specularFactor;\n\nconst float VIEW_DISTANCE = 24.0;\nconst float VIEW_FADE = 8.0;\n\nvec4 lit(float l ,float h, float m) {\n    return vec4(1.0,\n        max(l, 0.0),\n        (l > 0.0) ? pow(max(0.0, h), m) : 0.0,\n        1.0);\n}\n\nvoid main() {\n    vec3 a_normal = normalize(v_normal);\n    vec3 surfaceToView = normalize(v_surfaceToView);\n    vec3 halfVector = normalize(u_lightWorld + surfaceToView);\n    vec4 litR = lit(dot(a_normal, u_lightWorld),\n                   dot(a_normal,  surfaceToView), u_shininess);\n    vec4 outColor = vec4((\n        u_lightColor * (u_diffuse * litR.y + u_diffuse * u_ambient +\n            u_specular * litR.z * u_specularFactor)).rgb,\n        u_diffuse.a);\n\n    gl_FragColor = mix(outColor,vec4(0.4,0.8,1.0,1.0),v_distance > VIEW_DISTANCE ? min(1.0,(v_distance - VIEW_DISTANCE) / VIEW_FADE) : 0.0); \n}\n"},function(t,e){t.exports="uniform vec3 u_worldViewPos;\nuniform mat4 u_worldViewProjection;\nuniform mat4 u_world;\nuniform mat4 u_worldInverseTranspose;\n\nattribute vec4 a_position;\nattribute vec3 a_normal;\nattribute vec2 a_texcoord;\n\nvarying vec4 v_position;\nvarying vec2 v_texCoord;\nvarying vec3 v_normal;\nvarying vec3 v_surfaceToView;\nvarying float v_distance;\n\nvoid main() {\n    v_texCoord = a_texcoord;\n    v_position = (u_worldViewProjection * a_position);\n    v_normal = (u_worldInverseTranspose * vec4(a_normal, 0)).xyz;\n    v_surfaceToView = u_worldViewPos - (u_world * a_position).xyz;\n    v_distance = distance((u_world * a_position).xyz,u_worldViewPos);\n    gl_Position = v_position;\n}\n"},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.specimen=e.rover=e.camera=e.ground=e.empty=void 0;var a=r(16),o=n(a),i=r(17),u=n(i),l=r(15),s=n(l),f=r(18),c=n(f),h=r(19),d=n(h);e.empty=o["default"],e.ground=u["default"],e.camera=s["default"],e.rover=c["default"],e.specimen=d["default"]},function(t,e,r){var n=r(3),a={};a.create=function(){var t=new n.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},a.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},a.clone=function(t){var e=new n.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},a.fromValues=function(t,e,r,a,o,i,u,l,s){var f=new n.ARRAY_TYPE(9);return f[0]=t,f[1]=e,f[2]=r,f[3]=a,f[4]=o,f[5]=i,f[6]=u,f[7]=l,f[8]=s,f},a.set=function(t,e,r,n,a,o,i,u,l,s){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=o,t[5]=i,t[6]=u,t[7]=l,t[8]=s,t},a.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},a.transpose=function(t,e){if(t===e){var r=e[1],n=e[2],a=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=a}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},a.invert=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],u=e[5],l=e[6],s=e[7],f=e[8],c=f*i-u*s,h=-f*o+u*l,d=s*o-i*l,v=r*c+n*h+a*d;return v?(v=1/v,t[0]=c*v,t[1]=(-f*n+a*s)*v,t[2]=(u*n-a*i)*v,t[3]=h*v,t[4]=(f*r-a*l)*v,t[5]=(-u*r+a*o)*v,t[6]=d*v,t[7]=(-s*r+n*l)*v,t[8]=(i*r-n*o)*v,t):null},a.adjoint=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],u=e[5],l=e[6],s=e[7],f=e[8];return t[0]=i*f-u*s,t[1]=a*s-n*f,t[2]=n*u-a*i,t[3]=u*l-o*f,t[4]=r*f-a*l,t[5]=a*o-r*u,t[6]=o*s-i*l,t[7]=n*l-r*s,t[8]=r*i-n*o,t},a.determinant=function(t){var e=t[0],r=t[1],n=t[2],a=t[3],o=t[4],i=t[5],u=t[6],l=t[7],s=t[8];return e*(s*o-i*l)+r*(-s*a+i*u)+n*(l*a-o*u)},a.multiply=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=e[6],f=e[7],c=e[8],h=r[0],d=r[1],v=r[2],m=r[3],p=r[4],M=r[5],y=r[6],_=r[7],g=r[8];return t[0]=h*n+d*i+v*s,t[1]=h*a+d*u+v*f,t[2]=h*o+d*l+v*c,t[3]=m*n+p*i+M*s,t[4]=m*a+p*u+M*f,t[5]=m*o+p*l+M*c,t[6]=y*n+_*i+g*s,t[7]=y*a+_*u+g*f,t[8]=y*o+_*l+g*c,t},a.mul=a.multiply,a.translate=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=e[6],f=e[7],c=e[8],h=r[0],d=r[1];return t[0]=n,t[1]=a,t[2]=o,t[3]=i,t[4]=u,t[5]=l,t[6]=h*n+d*i+s,t[7]=h*a+d*u+f,t[8]=h*o+d*l+c,t},a.rotate=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=e[6],f=e[7],c=e[8],h=Math.sin(r),d=Math.cos(r);return t[0]=d*n+h*i,t[1]=d*a+h*u,t[2]=d*o+h*l,t[3]=d*i-h*n,t[4]=d*u-h*a,t[5]=d*l-h*o,t[6]=s,t[7]=f,t[8]=c,t},a.scale=function(t,e,r){var n=r[0],a=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=a*e[3],t[4]=a*e[4],t[5]=a*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},a.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},a.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},a.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},a.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},a.fromQuat=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=r+r,u=n+n,l=a+a,s=r*i,f=n*i,c=n*u,h=a*i,d=a*u,v=a*l,m=o*i,p=o*u,M=o*l;return t[0]=1-c-v,t[3]=f-M,t[6]=h+p,t[1]=f+M,t[4]=1-s-v,t[7]=d-m,t[2]=h-p,t[5]=d+m,t[8]=1-s-c,t},a.normalFromMat4=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],u=e[5],l=e[6],s=e[7],f=e[8],c=e[9],h=e[10],d=e[11],v=e[12],m=e[13],p=e[14],M=e[15],y=r*u-n*i,_=r*l-a*i,g=r*s-o*i,x=n*l-a*u,S=n*s-o*u,b=a*s-o*l,I=f*m-c*v,w=f*p-h*v,E=f*M-d*v,D=c*p-h*m,F=c*M-d*m,A=h*M-d*p,T=y*A-_*F+g*D+x*E-S*w+b*I;return T?(T=1/T,t[0]=(u*A-l*F+s*D)*T,t[1]=(l*E-i*A-s*w)*T,t[2]=(i*F-u*E+s*I)*T,t[3]=(a*F-n*A-o*D)*T,t[4]=(r*A-a*E+o*w)*T,t[5]=(n*E-r*F-o*I)*T,t[6]=(m*b-p*S+M*x)*T,t[7]=(p*g-v*b-M*_)*T,t[8]=(v*S-m*g+M*y)*T,t):null},a.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},a.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},a.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t},a.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t},a.sub=a.subtract,a.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t},a.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},a.equals=function(t,e){var r=t[0],a=t[1],o=t[2],i=t[3],u=t[4],l=t[5],s=t[6],f=t[7],c=t[8],h=e[0],d=e[1],v=e[2],m=e[3],p=e[4],M=e[5],y=t[6],_=e[7],g=e[8];return Math.abs(r-h)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(a-d)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(o-v)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(i-m)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(u-p)<=n.EPSILON*Math.max(1,Math.abs(u),Math.abs(p))&&Math.abs(l-M)<=n.EPSILON*Math.max(1,Math.abs(l),Math.abs(M))&&Math.abs(s-y)<=n.EPSILON*Math.max(1,Math.abs(s),Math.abs(y))&&Math.abs(f-_)<=n.EPSILON*Math.max(1,Math.abs(f),Math.abs(_))&&Math.abs(c-g)<=n.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))},t.exports=a},function(t,e,r){var n=r(3),a={};a.create=function(){var t=new n.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},a.clone=function(t){var e=new n.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},a.fromValues=function(t,e,r){var a=new n.ARRAY_TYPE(3);return a[0]=t,a[1]=e,a[2]=r,a},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},a.set=function(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t},a.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t},a.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t},a.sub=a.subtract,a.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t},a.mul=a.multiply,a.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t},a.div=a.divide,a.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},a.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},a.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t},a.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t},a.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},a.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},a.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t},a.distance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2];return Math.sqrt(r*r+n*n+a*a)},a.dist=a.distance,a.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2];return r*r+n*n+a*a},a.sqrDist=a.squaredDistance,a.length=function(t){var e=t[0],r=t[1],n=t[2];return Math.sqrt(e*e+r*r+n*n)},a.len=a.length,a.squaredLength=function(t){var e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n},a.sqrLen=a.squaredLength,a.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},a.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},a.normalize=function(t,e){var r=e[0],n=e[1],a=e[2],o=r*r+n*n+a*a;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t},a.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},a.cross=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=r[0],u=r[1],l=r[2];return t[0]=a*l-o*u,t[1]=o*i-n*l,t[2]=n*u-a*i,t},a.lerp=function(t,e,r,n){var a=e[0],o=e[1],i=e[2];return t[0]=a+n*(r[0]-a),t[1]=o+n*(r[1]-o),t[2]=i+n*(r[2]-i),t},a.hermite=function(t,e,r,n,a,o){var i=o*o,u=i*(2*o-3)+1,l=i*(o-2)+o,s=i*(o-1),f=i*(3-2*o);return t[0]=e[0]*u+r[0]*l+n[0]*s+a[0]*f,t[1]=e[1]*u+r[1]*l+n[1]*s+a[1]*f,t[2]=e[2]*u+r[2]*l+n[2]*s+a[2]*f,t},a.bezier=function(t,e,r,n,a,o){var i=1-o,u=i*i,l=o*o,s=u*i,f=3*o*u,c=3*l*i,h=l*o;return t[0]=e[0]*s+r[0]*f+n[0]*c+a[0]*h,t[1]=e[1]*s+r[1]*f+n[1]*c+a[1]*h,t[2]=e[2]*s+r[2]*f+n[2]*c+a[2]*h,t},a.random=function(t,e){e=e||1;var r=2*n.RANDOM()*Math.PI,a=2*n.RANDOM()-1,o=Math.sqrt(1-a*a)*e;return t[0]=Math.cos(r)*o,t[1]=Math.sin(r)*o,t[2]=a*e,t},a.transformMat4=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=r[3]*n+r[7]*a+r[11]*o+r[15];return i=i||1,t[0]=(r[0]*n+r[4]*a+r[8]*o+r[12])/i,t[1]=(r[1]*n+r[5]*a+r[9]*o+r[13])/i,t[2]=(r[2]*n+r[6]*a+r[10]*o+r[14])/i,t},a.transformMat3=function(t,e,r){var n=e[0],a=e[1],o=e[2];return t[0]=n*r[0]+a*r[3]+o*r[6],t[1]=n*r[1]+a*r[4]+o*r[7],t[2]=n*r[2]+a*r[5]+o*r[8],t},a.transformQuat=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=r[0],u=r[1],l=r[2],s=r[3],f=s*n+u*o-l*a,c=s*a+l*n-i*o,h=s*o+i*a-u*n,d=-i*n-u*a-l*o;return t[0]=f*s+d*-i+c*-l-h*-u,t[1]=c*s+d*-u+h*-i-f*-l,t[2]=h*s+d*-l+f*-u-c*-i,t},a.rotateX=function(t,e,r,n){var a=[],o=[];return a[0]=e[0]-r[0],a[1]=e[1]-r[1],a[2]=e[2]-r[2],o[0]=a[0],o[1]=a[1]*Math.cos(n)-a[2]*Math.sin(n),
o[2]=a[1]*Math.sin(n)+a[2]*Math.cos(n),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},a.rotateY=function(t,e,r,n){var a=[],o=[];return a[0]=e[0]-r[0],a[1]=e[1]-r[1],a[2]=e[2]-r[2],o[0]=a[2]*Math.sin(n)+a[0]*Math.cos(n),o[1]=a[1],o[2]=a[2]*Math.cos(n)-a[0]*Math.sin(n),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},a.rotateZ=function(t,e,r,n){var a=[],o=[];return a[0]=e[0]-r[0],a[1]=e[1]-r[1],a[2]=e[2]-r[2],o[0]=a[0]*Math.cos(n)-a[1]*Math.sin(n),o[1]=a[0]*Math.sin(n)+a[1]*Math.cos(n),o[2]=a[2],t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},a.forEach=function(){var t=a.create();return function(e,r,n,a,o,i){var u,l;for(r||(r=3),n||(n=0),l=a?Math.min(a*r+n,e.length):e.length,u=n;u<l;u+=r)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],o(t,t,i),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2];return e}}(),a.angle=function(t,e){var r=a.fromValues(t[0],t[1],t[2]),n=a.fromValues(e[0],e[1],e[2]);a.normalize(r,r),a.normalize(n,n);var o=a.dot(r,n);return o>1?0:Math.acos(o)},a.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},a.equals=function(t,e){var r=t[0],a=t[1],o=t[2],i=e[0],u=e[1],l=e[2];return Math.abs(r-i)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(a-u)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(o-l)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))},t.exports=a},function(t,e,r){var n=r(3),a={};a.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},a.clone=function(t){var e=new n.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},a.fromValues=function(t,e,r,a){var o=new n.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=r,o[3]=a,o},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},a.set=function(t,e,r,n,a){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t},a.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},a.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t},a.sub=a.subtract,a.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t},a.mul=a.multiply,a.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t},a.div=a.divide,a.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},a.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},a.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t},a.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t},a.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},a.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},a.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t},a.distance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(r*r+n*n+a*a+o*o)},a.dist=a.distance,a.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2],o=e[3]-t[3];return r*r+n*n+a*a+o*o},a.sqrDist=a.squaredDistance,a.length=function(t){var e=t[0],r=t[1],n=t[2],a=t[3];return Math.sqrt(e*e+r*r+n*n+a*a)},a.len=a.length,a.squaredLength=function(t){var e=t[0],r=t[1],n=t[2],a=t[3];return e*e+r*r+n*n+a*a},a.sqrLen=a.squaredLength,a.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},a.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},a.normalize=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=r*r+n*n+a*a+o*o;return i>0&&(i=1/Math.sqrt(i),t[0]=r*i,t[1]=n*i,t[2]=a*i,t[3]=o*i),t},a.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},a.lerp=function(t,e,r,n){var a=e[0],o=e[1],i=e[2],u=e[3];return t[0]=a+n*(r[0]-a),t[1]=o+n*(r[1]-o),t[2]=i+n*(r[2]-i),t[3]=u+n*(r[3]-u),t},a.random=function(t,e){return e=e||1,t[0]=n.RANDOM(),t[1]=n.RANDOM(),t[2]=n.RANDOM(),t[3]=n.RANDOM(),a.normalize(t,t),a.scale(t,t,e),t},a.transformMat4=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3];return t[0]=r[0]*n+r[4]*a+r[8]*o+r[12]*i,t[1]=r[1]*n+r[5]*a+r[9]*o+r[13]*i,t[2]=r[2]*n+r[6]*a+r[10]*o+r[14]*i,t[3]=r[3]*n+r[7]*a+r[11]*o+r[15]*i,t},a.transformQuat=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=r[0],u=r[1],l=r[2],s=r[3],f=s*n+u*o-l*a,c=s*a+l*n-i*o,h=s*o+i*a-u*n,d=-i*n-u*a-l*o;return t[0]=f*s+d*-i+c*-l-h*-u,t[1]=c*s+d*-u+h*-i-f*-l,t[2]=h*s+d*-l+f*-u-c*-i,t[3]=e[3],t},a.forEach=function(){var t=a.create();return function(e,r,n,a,o,i){var u,l;for(r||(r=4),n||(n=0),l=a?Math.min(a*r+n,e.length):e.length,u=n;u<l;u+=r)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],t[3]=e[u+3],o(t,t,i),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2],e[u+3]=t[3];return e}}(),a.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},a.equals=function(t,e){var r=t[0],a=t[1],o=t[2],i=t[3],u=e[0],l=e[1],s=e[2],f=e[3];return Math.abs(r-u)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(a-l)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(l))&&Math.abs(o-s)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(s))&&Math.abs(i-f)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(f))},t.exports=a},function(t,e,r){var n;!function(){"use strict";function a(t){t||(t=Math.random),this.p=new Uint8Array(256),this.perm=new Uint8Array(512),this.permMod12=new Uint8Array(512);for(var e=0;e<256;e++)this.p[e]=256*t();for(e=0;e<512;e++)this.perm[e]=this.p[255&e],this.permMod12[e]=this.perm[e]%12}var o=.5*(Math.sqrt(3)-1),i=(3-Math.sqrt(3))/6,u=1/3,l=1/6,s=(Math.sqrt(5)-1)/4,f=(5-Math.sqrt(5))/20;a.prototype={grad3:new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]),grad4:new Float32Array([0,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,1,0,1,1,1,0,1,-1,1,0,-1,1,1,0,-1,-1,-1,0,1,1,-1,0,1,-1,-1,0,-1,1,-1,0,-1,-1,1,1,0,1,1,1,0,-1,1,-1,0,1,1,-1,0,-1,-1,1,0,1,-1,1,0,-1,-1,-1,0,1,-1,-1,0,-1,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,0]),noise2D:function(t,e){var r,n,a=this.permMod12,u=this.perm,l=this.grad3,s=0,f=0,c=0,h=(t+e)*o,d=Math.floor(t+h),v=Math.floor(e+h),m=(d+v)*i,p=d-m,M=v-m,y=t-p,_=e-M;y>_?(r=1,n=0):(r=0,n=1);var g=y-r+i,x=_-n+i,S=y-1+2*i,b=_-1+2*i,I=255&d,w=255&v,E=.5-y*y-_*_;if(E>=0){var D=3*a[I+u[w]];E*=E,s=E*E*(l[D]*y+l[D+1]*_)}var F=.5-g*g-x*x;if(F>=0){var A=3*a[I+r+u[w+n]];F*=F,f=F*F*(l[A]*g+l[A+1]*x)}var T=.5-S*S-b*b;if(T>=0){var P=3*a[I+1+u[w+1]];T*=T,c=T*T*(l[P]*S+l[P+1]*b)}return 70*(s+f+c)},noise3D:function(t,e,r){var n,a,o,i,s,f,c,h,d,v,m=this.permMod12,p=this.perm,M=this.grad3,y=(t+e+r)*u,_=Math.floor(t+y),g=Math.floor(e+y),x=Math.floor(r+y),S=(_+g+x)*l,b=_-S,I=g-S,w=x-S,E=t-b,D=e-I,F=r-w;E>=D?D>=F?(s=1,f=0,c=0,h=1,d=1,v=0):E>=F?(s=1,f=0,c=0,h=1,d=0,v=1):(s=0,f=0,c=1,h=1,d=0,v=1):D<F?(s=0,f=0,c=1,h=0,d=1,v=1):E<F?(s=0,f=1,c=0,h=0,d=1,v=1):(s=0,f=1,c=0,h=1,d=1,v=0);var A=E-s+l,T=D-f+l,P=F-c+l,R=E-h+2*l,C=D-d+2*l,O=F-v+2*l,z=E-1+3*l,k=D-1+3*l,U=F-1+3*l,N=255&_,L=255&g,B=255&x,V=.6-E*E-D*D-F*F;if(V<0)n=0;else{var q=3*m[N+p[L+p[B]]];V*=V,n=V*V*(M[q]*E+M[q+1]*D+M[q+2]*F)}var j=.6-A*A-T*T-P*P;if(j<0)a=0;else{var Y=3*m[N+s+p[L+f+p[B+c]]];j*=j,a=j*j*(M[Y]*A+M[Y+1]*T+M[Y+2]*P)}var G=.6-R*R-C*C-O*O;if(G<0)o=0;else{var X=3*m[N+h+p[L+d+p[B+v]]];G*=G,o=G*G*(M[X]*R+M[X+1]*C+M[X+2]*O)}var W=.6-z*z-k*k-U*U;if(W<0)i=0;else{var H=3*m[N+1+p[L+1+p[B+1]]];W*=W,i=W*W*(M[H]*z+M[H+1]*k+M[H+2]*U)}return 32*(n+a+o+i)},noise4D:function(t,e,r,n){var a,o,i,u,l,c=(this.permMod12,this.perm),h=this.grad4,d=(t+e+r+n)*s,v=Math.floor(t+d),m=Math.floor(e+d),p=Math.floor(r+d),M=Math.floor(n+d),y=(v+m+p+M)*f,_=v-y,g=m-y,x=p-y,S=M-y,b=t-_,I=e-g,w=r-x,E=n-S,D=0,F=0,A=0,T=0;b>I?D++:F++,b>w?D++:A++,b>E?D++:T++,I>w?F++:A++,I>E?F++:T++,w>E?A++:T++;var P,R,C,O,z,k,U,N,L,B,V,q;P=D>=3?1:0,R=F>=3?1:0,C=A>=3?1:0,O=T>=3?1:0,z=D>=2?1:0,k=F>=2?1:0,U=A>=2?1:0,N=T>=2?1:0,L=D>=1?1:0,B=F>=1?1:0,V=A>=1?1:0,q=T>=1?1:0;var j=b-P+f,Y=I-R+f,G=w-C+f,X=E-O+f,W=b-z+2*f,H=I-k+2*f,Q=w-U+2*f,K=E-N+2*f,Z=b-L+3*f,$=I-B+3*f,J=w-V+3*f,tt=E-q+3*f,et=b-1+4*f,rt=I-1+4*f,nt=w-1+4*f,at=E-1+4*f,ot=255&v,it=255&m,ut=255&p,lt=255&M,st=.6-b*b-I*I-w*w-E*E;if(st<0)a=0;else{var ft=c[ot+c[it+c[ut+c[lt]]]]%32*4;st*=st,a=st*st*(h[ft]*b+h[ft+1]*I+h[ft+2]*w+h[ft+3]*E)}var ct=.6-j*j-Y*Y-G*G-X*X;if(ct<0)o=0;else{var ht=c[ot+P+c[it+R+c[ut+C+c[lt+O]]]]%32*4;ct*=ct,o=ct*ct*(h[ht]*j+h[ht+1]*Y+h[ht+2]*G+h[ht+3]*X)}var dt=.6-W*W-H*H-Q*Q-K*K;if(dt<0)i=0;else{var vt=c[ot+z+c[it+k+c[ut+U+c[lt+N]]]]%32*4;dt*=dt,i=dt*dt*(h[vt]*W+h[vt+1]*H+h[vt+2]*Q+h[vt+3]*K)}var mt=.6-Z*Z-$*$-J*J-tt*tt;if(mt<0)u=0;else{var pt=c[ot+L+c[it+B+c[ut+V+c[lt+q]]]]%32*4;mt*=mt,u=mt*mt*(h[pt]*Z+h[pt+1]*$+h[pt+2]*J+h[pt+3]*tt)}var Mt=.6-et*et-rt*rt-nt*nt-at*at;if(Mt<0)l=0;else{var yt=c[ot+1+c[it+1+c[ut+1+c[lt+1]]]]%32*4;Mt*=Mt,l=Mt*Mt*(h[yt]*et+h[yt+1]*rt+h[yt+2]*nt+h[yt+3]*at)}return 27*(a+o+i+u+l)}},n=function(){return a}.call(e,r,e,t),!(void 0!==n&&(t.exports=n)),e.SimplexNoise=a,t.exports=a}()},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.WorldRunner=e.World=e.Entity=void 0;var o=function(){function t(t,e){var r=[],n=!0,a=!1,o=void 0;try{for(var i,u=t[Symbol.iterator]();!(n=(i=u.next()).done)&&(r.push(i.value),!e||r.length!==e);n=!0);}catch(l){a=!0,o=l}finally{try{!n&&u["return"]&&u["return"]()}finally{if(a)throw o}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=r(2),l=(n(u),e.Entity=function(){function t(e,r){a(this,t),this.id=e,this._components=new Map,this._world=r}return i(t,[{key:"addComponent",value:function(t){return this._components.set(t.getType(),t),this._world.changeEntity(this),this}},{key:"removeComponent",value:function(t){return this._components["delete"](t.getType()),this._world.changeEntity(this),this}},{key:"getComponent",value:function(t){return this._components.get(t)}},{key:"hasComponent",value:function(t){return!!this._components.get(t)}}]),t}());e.World=function(){function t(e,r,n,o,i){a(this,t),this._simSystems=[],this._renderSystems=[],this._entities=new Map,this._nextId=0,this._freeIds=[],this._aspect=o,this._fov=i,this._maxWidth=n,this._canvas=e,this._glContext=r,this._building=!1}return i(t,[{key:"mountSimSystems",value:function(t){var e=!0,r=!1,n=void 0;try{for(var a,i=this._simSystems[Symbol.iterator]();!(e=(a=i.next()).done);e=!0){var u=a.value;u.systemWillUnmount&&u.systemWillUnmount(this,this._canvas)}}catch(l){r=!0,n=l}finally{try{!e&&i["return"]&&i["return"]()}finally{if(r)throw n}}this._simSystems=t;var s=!0,f=!1,c=void 0;try{for(var h,d=this._simSystems[Symbol.iterator]();!(s=(h=d.next()).done);s=!0){var v=h.value;v.systemWillMount&&v.systemWillMount(this,this._canvas)}}catch(l){f=!0,c=l}finally{try{!s&&d["return"]&&d["return"]()}finally{if(f)throw c}}var m=!0,p=!1,M=void 0;try{for(var y,_=this._entities[Symbol.iterator]();!(m=(y=_.next()).done);m=!0){var g=o(y.value,2),x=(g[0],g[1]),S=!0,b=!1,I=void 0;try{for(var w,E=this._simSystems[Symbol.iterator]();!(S=(w=E.next()).done);S=!0){var D=w.value;D.worldAddingEntity(x)}}catch(l){b=!0,I=l}finally{try{!S&&E["return"]&&E["return"]()}finally{if(b)throw I}}}}catch(l){p=!0,M=l}finally{try{!m&&_["return"]&&_["return"]()}finally{if(p)throw M}}}},{key:"mountRenderSystems",value:function(t){this._renderSystems=t;var e=!0,r=!1,n=void 0;try{for(var a,i=this._entities[Symbol.iterator]();!(e=(a=i.next()).done);e=!0){var u=o(a.value,2),l=(u[0],u[1]),s=!0,f=!1,c=void 0;try{for(var h,d=this._renderSystems[Symbol.iterator]();!(s=(h=d.next()).done);s=!0){var v=h.value;v.worldAddingEntity(l)}}catch(m){f=!0,c=m}finally{try{!s&&d["return"]&&d["return"]()}finally{if(f)throw c}}}}catch(m){r=!0,n=m}finally{try{!e&&i["return"]&&i["return"]()}finally{if(r)throw n}}}},{key:"clear",value:function(){var t=!0,e=!1,r=void 0;try{for(var n,a=this._entities[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){var i=o(n.value,2),u=(i[0],i[1]),l=!0,s=!1,f=void 0;try{for(var c,h=this._simSystems[Symbol.iterator]();!(l=(c=h.next()).done);l=!0){var d=c.value;d.worldRemovingEntity(u)}}catch(v){s=!0,f=v}finally{try{!l&&h["return"]&&h["return"]()}finally{if(s)throw f}}var m=!0,p=!1,M=void 0;try{for(var y,_=this._renderSystems[Symbol.iterator]();!(m=(y=_.next()).done);m=!0){var g=y.value;g.worldRemovingEntity(u)}}catch(v){p=!0,M=v}finally{try{!m&&_["return"]&&_["return"]()}finally{if(p)throw M}}}}catch(v){e=!0,r=v}finally{try{!t&&a["return"]&&a["return"]()}finally{if(e)throw r}}}},{key:"resizeViewPort",value:function(t,e){var r=Math.min(this._maxWidth,t),n=r/this._aspect;n>e&&(r=e*this._aspect,n=e);var a=this._glContext.canvas;a.style.width=r+"px",a.style.height=n+"px";var o=window.devicePixelRatio||1;r*=o,n*=o,a.clientWidth===a.width&&a.clientHeight===a.height||(a.width=r,a.height=n,this._glContext.viewport(0,0,r,n))}},{key:"simulate",value:function(t){var e=!0,r=!1,n=void 0;try{for(var a,o=this._simSystems[Symbol.iterator]();!(e=(a=o.next()).done);e=!0){var i=a.value;i.simulate(t)}}catch(u){r=!0,n=u}finally{try{!e&&o["return"]&&o["return"]()}finally{if(r)throw n}}}},{key:"render",value:function(t){this._glContext.clearColor(.4,.8,1,1),this._glContext.clear(this._glContext.COLOR_BUFFER_BIT|this._glContext.DEPTH_BUFFER_BIT);var e=!0,r=!1,n=void 0;try{for(var a,o=this._renderSystems[Symbol.iterator]();!(e=(a=o.next()).done);e=!0){var i=a.value;i.render(this._glContext,t)}}catch(u){r=!0,n=u}finally{try{!e&&o["return"]&&o["return"]()}finally{if(r)throw n}}}},{key:"createEntity",value:function(t,e){var r=void 0;this._freeIds.length?(r=this._freeIds[this._freeIds.length-1],this._freeIds.pop()):r=this._nextId++,this._building=!0;var n=t(new l(r,this),this._glContext,e);this._building=!1,this._entities.set(n.id,n);var a=!0,o=!1,i=void 0;try{for(var u,s=this._simSystems[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){var f=u.value;f.worldAddingEntity(n)}}catch(c){o=!0,i=c}finally{try{!a&&s["return"]&&s["return"]()}finally{if(o)throw i}}var h=!0,d=!1,v=void 0;try{for(var m,p=this._renderSystems[Symbol.iterator]();!(h=(m=p.next()).done);h=!0){var M=m.value;M.worldAddingEntity(n)}}catch(c){d=!0,v=c}finally{try{!h&&p["return"]&&p["return"]()}finally{if(d)throw v}}return n}},{key:"removeEntity",value:function(t){var e=!0,r=!1,n=void 0;try{for(var a,o=this._simSystems[Symbol.iterator]();!(e=(a=o.next()).done);e=!0){var i=a.value;i.worldRemovingEntity(t)}}catch(u){r=!0,n=u}finally{try{!e&&o["return"]&&o["return"]()}finally{if(r)throw n}}var l=!0,s=!1,f=void 0;try{for(var c,h=this._renderSystems[Symbol.iterator]();!(l=(c=h.next()).done);l=!0){var d=c.value;d.worldRemovingEntity(t)}}catch(u){s=!0,f=u}finally{try{!l&&h["return"]&&h["return"]()}finally{if(s)throw f}}this._entities["delete"](t.id),this._freeIds.push(t.id)}},{key:"changeEntity",value:function(t){if(!this._building){var e=!0,r=!1,n=void 0;try{for(var a,o=this._simSystems[Symbol.iterator]();!(e=(a=o.next()).done);e=!0){var i=a.value;i.worldRemovingEntity(t),i.worldAddingEntity(t)}}catch(u){r=!0,n=u}finally{try{!e&&o["return"]&&o["return"]()}finally{if(r)throw n}}var l=!0,s=!1,f=void 0;try{for(var c,h=this._renderSystems[Symbol.iterator]();!(l=(c=h.next()).done);l=!0){var d=c.value;d.worldRemovingEntity(t),d.worldAddingEntity(t)}}catch(u){s=!0,f=u}finally{try{!l&&h["return"]&&h["return"]()}finally{if(s)throw f}}}}},{key:"findEntity",value:function(t){return this._entities.get(t)}}]),t}(),e.WorldRunner=function(){function t(e,r){a(this,t),this._world=e,this._frameTime=1e3/r,this._frameDelta=0,this._lastFrameTime=0,this._step=this._step.bind(this)}return i(t,[{key:"start",value:function(){window.requestAnimationFrame(this._step)}},{key:"_step",value:function(t){this._frameDelta+=t-this._lastFrameTime,this._lastFrameTime=t;for(var e=0;this._frameDelta>=this._frameTime&&(this._world.simulate(this._frameTime),this._frameDelta-=this._frameTime,!(++e>240)););this._world.render(this._frameDelta/this._frameTime),window.requestAnimationFrame(this._step)}}]),t}()},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=function(t){return[new o["default"](t),new u["default"](t),new s["default"](t),new c["default"](t),new d["default"](t)]};var a=r(26),o=n(a),i=r(27),u=n(i),l=r(28),s=n(l),f=r(29),c=n(f),h=r(30),d=n(h)},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=function(){return[new u["default"],new s["default"],new o["default"]]};var a=r(33),o=n(a),i=r(31),u=n(i),l=r(32),s=n(l)},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e["default"]=t,e}function o(t){t.createEntity(u.camera,{lockPitch:!0,fov:45,position:s["default"].vec3.fromValues(0,5,10),focalPoint:s["default"].vec3.fromValues(0,0,0)}),t.createEntity(u.rover,{position:s["default"].vec3.fromValues(0,0,0),rotation:s["default"].quat.create(),mass:300}),t.createEntity(u.ground,{noiseParams:{frequency:.007,amplitude:15,persistence:.2,lacunarity:4,octaves:6}})}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=o;var i=r(6),u=a(i),l=r(1),s=n(l)},function(t,e,r){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e["default"]=t,e}function a(t,e,r){return t.addComponent(new i.CameraComponent(r.lockPitch,r.fov,r.position,r.focalPoint))}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=a;var o=r(0),i=n(o)},function(t,e,r){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e["default"]=t,e}function a(t,e){return t}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=a;var o=r(0);n(o)},function(t,e,r){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e["default"]=t,e}function a(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,r){var n=new u["default"];return t.addComponent(new s.GroundComponent(e,n,r.noiseParams))}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=o;var i=r(10),u=a(i),l=r(0),s=n(l)},function(t,e,r){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e["default"]=t,e}function a(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,r){return t.addComponent(new l.RoverComponent(e,r.position,r.rotation,r.mass)).addComponent(new l.ScoreComponent)}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=o;var i=r(10),u=(a(i),r(0)),l=n(u)},function(t,e,r){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e["default"]=t,e}function a(t,e,r){return t.addComponent(new i.SpecimenComponent(r.position,r.specimenType))}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=a;var o=r(0),i=n(o)},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=r(2),u=(n(i),r(1)),l=n(u),s=l["default"].vec3.fromValues(0,1,0),f=l["default"].vec3.fromValues(1,0,0),c=function(){function t(e,r,n,o){a(this,t),this._lockPitch=e,this._accumPitch=0,this._fov=r,this._position=l["default"].vec3.create(),this._projectionMatrix=l["default"].mat4.create(),this._viewMatrix=l["default"].mat4.create(),this._rotation=l["default"].quat.create(),this._up=l["default"].vec3.clone(s),this.setFocalPointAndPosition(l["default"].vec3.fromValues.apply(l["default"].vec3,o),l["default"].vec3.fromValues.apply(l["default"].vec3,n))}return o(t,[{key:"getType",value:function(){return t.Type}}]),o(t,[{key:"setProjectionMatrix",value:function(t){l["default"].mat4.perspective(this._projectionMatrix,this._fov*(Math.PI/180),t.drawingBufferWidth/t.drawingBufferHeight,.5,1e3)}},{key:"setUp",value:function(t,e){e?l["default"].vec3.lerp(this._up,this._up,t,e):l["default"].vec3.copy(this._up,t),l["default"].vec3.normalize(this._up,this._up)}},{key:"_setAxes",value:function(t,e,r){l["default"].quat.setAxes(this._rotation,t,r,e),this._lockPitch&&(this._accumPitch=Math.asin(t[1]*-1))}},{key:"setFocalPoint",value:function(t,e,r){this.setFocalPointAndPosition(t,this._position,r)}},{key:"setFocalPointAndPosition",value:function(t,e,r,n){n?l["default"].vec3.lerp(this._position,this._position,e,n):l["default"].vec3.copy(this._position,e);var a=l["default"].vec3.create(),o=l["default"].vec3.create(),i=l["default"].vec3.create();if(l["default"].vec3.sub(a,t,this._position),l["default"].vec3.normalize(a,a),r){var u=this.getLookAt();l["default"].vec3.scale(u,u,-1),l["default"].vec3.lerp(a,u,a,r)}l["default"].vec3.cross(o,a,this._up),l["default"].vec3.normalize(o,o),l["default"].vec3.cross(i,o,a),this._setAxes(a,i,o)}},{key:"setPosition",value:function(t){l["default"].vec3.copy(this._position,t)}},{key:"move",value:function(t){l["default"].vec3.add(this._position,this._position,t)}},{key:"rotYaw",value:function(t){l["default"].quat.rotateY(this._rotation,this._rotation,t)}},{key:"rotPitch",value:function(t){this._lockPitch&&(t>Math.PI/2&&(t=Math.PI/2),t<-(Math.PI/2)&&(t=-Math.PI/2),this._accumPitch+=t,this._accumPitch>Math.PI/2&&(t=Math.PI/2-(this._accumPitch-t),this._accumPitch=Math.PI/2),this._accumPitch<-(Math.PI/2)&&(t=-(Math.PI/2)-(this._accumPitch-t),this._accumPitch=-(Math.PI/2)));var e=l["default"].quat.create();l["default"].quat.setAxisAngle(e,f,t),l["default"].quat.mul(this._rotation,e,this._rotation)}},{key:"getProjectionMatrix",value:function(){return l["default"].mat4.clone(this._projectionMatrix)}},{key:"getPosition",value:function(){return l["default"].vec3.clone(this._position)}},{key:"getLookAt",value:function(){var t=l["default"].mat3.create();return l["default"].mat3.fromQuat(t,this._rotation),l["default"].vec3.fromValues(t[2],t[5],t[8])}},{key:"getRight",value:function(){var t=l["default"].mat3.create();return l["default"].mat3.fromQuat(t,this._rotation),l["default"].vec3.fromValues(t[0],t[3],t[6])}},{key:"getUp",value:function(){var t=l["default"].mat3.create();return l["default"].mat3.fromQuat(t,this._rotation),l["default"].vec3.fromValues(t[1],t[4],t[7])}},{key:"getViewMatrix",value:function(){var t=l["default"].vec3.create(),e=l["default"].mat4.create();return l["default"].vec3.scale(t,this._position,-1),l["default"].mat4.clone(l["default"].mat4.mul(this._viewMatrix,l["default"].mat4.fromQuat(l["default"].mat4.create(),this._rotation),l["default"].mat4.fromTranslation(e,t)))}}]),t}();c.Type="CAMERA_COMPONENT",e["default"]=c},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=r(2),u=n(i),l=r(1),s=n(l),f=1,c=32,h=c/2,d=32,v=5,m=.5,p=3,M=function(){function t(e,r,n){a(this,t),this._noiseFunc=this._createNoiseFunc(r,n),this._gl=e,this.chunks=[],this._createChunk(e,-h,-h)}return o(t,[{key:"getType",value:function(){return t.Type}}]),o(t,[{key:"_createChunk",value:function(t,e,r){var n=!0,a=!1,o=void 0;try{for(var i,l=this.chunks[Symbol.iterator]();!(n=(i=l.next()).done);n=!0){var f=i.value;if(f.boundingQuad[3]===e&&f.boundingQuad[0]===r)return f}}catch(v){a=!0,o=v}finally{try{!n&&l["return"]&&l["return"]()}finally{if(a)throw o}}var m={center:s["default"].vec3.fromValues(e+h,0,r+h),boundingQuad:s["default"].vec4.fromValues(r,e+c,r+c,e),heightMap:[],normalMap:[],vertices:u["default"].primitives.createPlaneVertices(c,c,d,d,null),obstacles:[]};return console.log("Creating chunk at ",m.center),this._createHeightMap(m),this._spawnObstacles(m),m.bufferInfo=u["default"].createBufferInfoFromArrays(t,m.vertices),this.chunks.push(m),m}},{key:"_createNoiseFunc",value:function(t,e){return function(r,n){for(var a=e.frequency,o=e.amplitude,i=0,u=0;u<e.octaves;++u)i+=t.noise2D(r*a,n*a)*o,a*=e.lacunarity,o*=e.persistence;return i}}},{key:"_createHeightMap",value:function(t){for(var e=t.vertices.position,r=t.vertices.normal,n=0;n<e.length;n+=3){var a=e[n]+t.center[0],o=e[n+2]+t.center[2],i=this._noiseFunc(a,o);e[n+1]=i;var u=this._cacheHeightMap(t,a,i,o);r[n]=u[0],r[n+1]=u[1],r[n+2]=u[2]}}},{key:"_spawnObstacles",value:function(t){for(var e=Math.floor(Math.random()*v),r=0;r<e;++r){var n=t.boundingQuad[3]+p+Math.floor(Math.random()*(c-2*p)),a=t.boundingQuad[0]+p+Math.floor(Math.random()*(c-2*p)),o=m+Math.floor(Math.random()*(p-m));t.obstacles.push({position:s["default"].vec3.fromValues(n,this._getHeightAndNormalAt(t,n,a).height,a),size:s["default"].vec3.fromValues(o,o,o)})}}},{key:"getActiveChunk",value:function(t,e){var r=!0,n=!1,a=void 0;try{for(var o,i=this.chunks[Symbol.iterator]();!(r=(o=i.next()).done);r=!0){var u=o.value;if(t>=u.boundingQuad[3]&&t<u.boundingQuad[1]&&e>=u.boundingQuad[0]&&e<u.boundingQuad[2])return u}}catch(l){n=!0,a=l}finally{try{!r&&i["return"]&&i["return"]()}finally{if(n)throw a}}return null}},{key:"getChunkCenter",value:function(t,e){return s["default"].vec2.fromValues(Math.floor(((t<0?Math.floor(t):Math.ceil(t))+h)/c)*c,Math.floor(((e<0?Math.floor(e):Math.ceil(e))+h)/c)*c)}},{key:"_lookupHeightMap",value:function(t,e,r){if(t.heightMap[e]&&null!=t.heightMap[e][r])return t.heightMap[e][r];var n=this._noiseFunc(e,r);return this._cacheHeightMap(t,e,n,r),t.heightMap[e]?void 0:n}},{key:"_cacheHeightMap",value:function(t,e,r,n){var a=s["default"].vec3.create(),o=s["default"].vec3.create(),i=s["default"].vec3.create(),u=s["default"].vec3.create(),l=s["default"].vec3.create(),c=s["default"].vec3.create(),h=s["default"].vec3.create(),d=s["default"].vec3.create(),v=s["default"].vec3.create();return s["default"].vec3.set(a,e,this._noiseFunc(e,n-f),n-f),s["default"].vec3.set(o,e,this._noiseFunc(e,n+f),n+f),s["default"].vec3.set(i,e-f,this._noiseFunc(e-f,n),n),s["default"].vec3.set(u,e+f,this._noiseFunc(e+f,n),n),s["default"].vec3.set(l,e-.7*f,this._noiseFunc(e-.7*f,n-.7*f),n-.7*f),s["default"].vec3.set(c,e+.7*f,this._noiseFunc(e+.7*f,n+.7*f),n+.7*f),s["default"].vec3.set(h,e-.7*f,this._noiseFunc(e-.7*f,n+.7*f),n+.7*f),s["default"].vec3.set(d,e+.7*f,this._noiseFunc(e+.7*f,n-.7*f),n-.7*f),s["default"].vec3.sub(a,o,a),s["default"].vec3.sub(o,u,i),s["default"].vec3.sub(l,c,l),s["default"].vec3.sub(c,d,h),s["default"].vec3.cross(a,a,o),s["default"].vec3.cross(l,l,c),s["default"].vec3.normalize(v,s["default"].vec3.add(v,a,l)),t.heightMap[e]||(t.heightMap[e]=[],t.normalMap[e]=[]),t.heightMap[e][n]=r,t.normalMap[e][n]=v,v}},{key:"ensureChunks",value:function(t,e,r,n){for(var a=s["default"].vec3.fromValues(t,0,e),o=this.chunks.length-1;o>=0;--o)s["default"].vec3.distance(a,this.chunks[o].center)>n&&(console.log("Culling chunk at ",this.chunks[o].center),this.chunks.splice(o,1));if(!this.getActiveChunk(t-r,e)){var i=this.getChunkCenter(t-r,e);this._createChunk(this._gl,i[0]-h,i[1]-h)}if(!this.getActiveChunk(t+r,e)){var u=this.getChunkCenter(t+r,e);this._createChunk(this._gl,u[0]-h,u[1]-h)}if(!this.getActiveChunk(t,e-r)){var l=this.getChunkCenter(t,e-r);this._createChunk(this._gl,l[0]-h,l[1]-h)}if(!this.getActiveChunk(t,e+r)){var f=this.getChunkCenter(t,e+r);this._createChunk(this._gl,f[0]-h,f[1]-h)}if(!this.getActiveChunk(t-.7*r,e-.7*r)){var c=this.getChunkCenter(t-.7*r,e-.7*r);this._createChunk(this._gl,c[0]-h,c[1]-h)}if(!this.getActiveChunk(t+.7*r,e+.7*r)){var d=this.getChunkCenter(t+.7*r,e+.7*r);this._createChunk(this._gl,d[0]-h,d[1]-h)}if(!this.getActiveChunk(t+.7*r,e-.7*r)){var v=this.getChunkCenter(t+.7*r,e-.7*r);this._createChunk(this._gl,v[0]-h,v[1]-h)}if(!this.getActiveChunk(t-.7*r,e+.7*r)){var m=this.getChunkCenter(t-.7*r,e+.7*r);this._createChunk(this._gl,m[0]-h,m[1]-h)}}},{key:"getHeightAndNormalAt",value:function(t,e){var r=this.getActiveChunk(t,e);return r?this._getHeightAndNormalAt(r,t,e):null}},{key:"_getHeightAndNormalAt",value:function(t,e,r){var n=Math.floor(e),a=Math.floor(r),o=n===e?e+1:Math.ceil(e),i=a===r?r+1:Math.ceil(r),u=e-n,l=r-a,f=void 0,c=void 0,h=void 0,d=s["default"].vec3.create(),v=s["default"].vec3.create(),m=s["default"].vec3.create();u>=l?(f=s["default"].vec3.fromValues(n,this._lookupHeightMap(t,n,a),a),c=s["default"].vec3.fromValues(o,this._lookupHeightMap(t,o,a),a),h=s["default"].vec3.fromValues(o,this._lookupHeightMap(t,o,i),i),s["default"].vec3.sub(d,f,c),s["default"].vec3.sub(v,h,c)):(f=s["default"].vec3.fromValues(o,this._lookupHeightMap(t,o,i),i),c=s["default"].vec3.fromValues(n,this._lookupHeightMap(t,n,i),i),h=s["default"].vec3.fromValues(n,this._lookupHeightMap(t,n,a),a),s["default"].vec3.sub(d,c,f),s["default"].vec3.sub(v,c,h)),s["default"].vec3.normalize(d,d),s["default"].vec3.normalize(v,v),s["default"].vec3.normalize(m,s["default"].vec3.cross(m,d,v));var p=-(m[0]*f[0]+m[1]*f[1]+m[2]*f[2]),M=-(p+m[0]*e+m[2]*r)/m[1];return{height:M,normal:m,tangent:d,binormal:v,chunk:t}}}]),t}();M.Type="GROUND_COMPONENT",e["default"]=M},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=r(2),u=(n(i),r(1)),l=n(u),s=function(){function t(e,r,n,o){a(this,t),this.position=r,this.rotation=n,this.velocity=l["default"].vec3.create(),this.mass=o,this.surfaceRotation=l["default"].quat.create(),this.surfaceNormal=null,this.turning=0,this.tilt=0,this.boostRemaining=100}return o(t,[{key:"getType",value:function(){return t.Type}}]),t}();s.Type="ROVER_COMPONENT",e["default"]=s},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=r(2),u=(n(i),r(1)),l=(n(u),function(){function t(){a(this,t),this.updated=!1,this.value=0}return o(t,[{key:"getType",value:function(){return t.Type}}]),o(t,[{key:"bump",value:function(t){this.updated=!0,this.value+=t.value}}]),t}());l.Type="SCORE_COMPONENT",e["default"]=l;
},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=r(2),u=(n(i),r(1)),l=n(u),s=.03,f=.1,c=.14,h=function(){function t(e,r){switch(a(this,t),this.position=e,this.startPosition=l["default"].vec3.clone(e),r){case t.SMALL_TYPE:this.value=1,this.size=l["default"].vec3.fromValues(1,1,1),this.color=l["default"].vec4.fromValues(0,0,1,1),this.idleSpeed=s,this.panicSpeed=f;break;case t.LARGE_TYPE:this.value=10,this.size=l["default"].vec3.fromValues(2,2,2),this.color=l["default"].vec4.fromValues(1,0,0,1),this.idleSpeed=s,this.panicSpeed=c}this.originalSize=l["default"].vec3.clone(this.size),this.rotation=l["default"].quat.create(),this.surfaceRotation=l["default"].quat.create(),this.specimenType=r}return o(t,[{key:"getType",value:function(){return t.Type}}]),t}();h.Type="SPECIMEN_COMPONENT",h.SMALL_TYPE=0,h.LARGE_TYPE=1,e["default"]=h},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}var a=r(2),o=n(a),i=r(11),u=r(14),l=n(u),s=r(13),f=n(s),c=r(12),h=n(c),d=document.getElementById("canvas");d.focus();var v=o["default"].getWebGLContext(d);o["default"].setDefaults({attribPrefix:"a_"});var m=new i.World(d,v,1920,16/9,45);m.mountSimSystems((0,f["default"])()),m.mountRenderSystems((0,h["default"])(v)),m.resizeViewPort(window.innerWidth,window.innerHeight),(0,l["default"])(m);var p=new i.WorldRunner(m,60);p.start(),window.addEventListener("resize",function(){m.resizeViewPort(window.innerWidth,window.innerHeight)})},function(t,e,r){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e["default"]=t,e}function a(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=r(2),l=(a(u),r(0)),s=n(l),f=function(){function t(e){o(this,t)}return i(t,[{key:"worldAddingEntity",value:function(t){var e=t.getComponent(s.CameraComponent.Type);e&&(this._camera=e)}},{key:"worldRemovingEntity",value:function(t){var e=t.getComponent(s.CameraComponent.Type);e&&(this._camera=null)}},{key:"render",value:function(t,e){this._camera&&this._camera.setProjectionMatrix(t)}}]),t}();e["default"]=f},function(t,e,r){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e["default"]=t,e}function a(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=r(2),l=a(u),s=r(1),f=a(s),c=r(4),h=a(c),d=r(5),v=a(d),m=r(0),p=n(m),M=function(){function t(e){o(this,t),this._programInfo=l["default"].createProgramInfo(e,[v["default"],h["default"]]),this._sphereBufferInfo=l["default"].primitives.createSphereBufferInfo(e,1,10,10),this._tex=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this._tex),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,2,2,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array([255,255,255,255,192,192,192,255,192,192,192,255,255,255,255,255])),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST)}return i(t,[{key:"worldAddingEntity",value:function(t){var e=t.getComponent(p.GroundComponent.Type);e&&(this._ground=e);var r=t.getComponent(p.CameraComponent.Type);r&&(this._camera=r)}},{key:"worldRemovingEntity",value:function(t){var e=t.getComponent(p.GroundComponent.Type);e&&(this._ground=null);var r=t.getComponent(p.CameraComponent.Type);r&&(this._camera=null)}},{key:"render",value:function(t,e){if(this._camera){var r=this._camera;if(this._ground){var n=this._ground,a=r.getViewMatrix(),o=f["default"].mat4.create(),i=f["default"].mat4.create(),u=f["default"].mat4.create(),s=f["default"].mat4.create(),c=r.getPosition();r.getLookAt();f["default"].mat4.mul(i,r.getProjectionMatrix(),a),f["default"].mat4.invert(o,a),t.useProgram(this._programInfo.program),t.enable(t.DEPTH_TEST),t.enable(t.CULL_FACE);var h=!0,d=!1,v=void 0;try{for(var m,p=n.chunks[Symbol.iterator]();!(h=(m=p.next()).done);h=!0){var M=m.value,y=f["default"].mat4.create();f["default"].mat4.translate(y,y,M.center),f["default"].mat4.mul(u,i,y),f["default"].mat4.invert(s,f["default"].mat4.transpose(s,y)),l["default"].setBuffersAndAttributes(t,this._programInfo,M.bufferInfo),l["default"].setUniforms(this._programInfo,{u_lightWorld:[0,1,0],u_lightColor:[1,1,1,1],u_ambient:[.2,.2,.2,1],u_specular:[1,1,1,1],u_shininess:100,u_specularFactor:0,u_diffuse:[.3,.5,.3,1],u_world:y,u_worldInverseTranspose:s,u_worldViewProjection:u,u_worldViewPos:c}),l["default"].drawBufferInfo(t,t.TRIANGLES,M.bufferInfo)}}catch(_){d=!0,v=_}finally{try{!h&&p["return"]&&p["return"]()}finally{if(d)throw v}}var g=!0,x=!1,S=void 0;try{for(var b,I=n.chunks[Symbol.iterator]();!(g=(b=I.next()).done);g=!0){var w=b.value;l["default"].setBuffersAndAttributes(t,this._programInfo,this._sphereBufferInfo);var E=!0,D=!1,F=void 0;try{for(var A,T=w.obstacles[Symbol.iterator]();!(E=(A=T.next()).done);E=!0){var P=A.value,R=f["default"].mat4.create();f["default"].mat4.translate(R,R,P.position);var C=f["default"].mat4.create();f["default"].mat4.scale(C,C,P.size),f["default"].mat4.mul(R,R,C),f["default"].mat4.mul(u,i,R),f["default"].mat4.invert(s,f["default"].mat4.transpose(s,R)),l["default"].setUniforms(this._programInfo,{u_lightWorld:[0,1,0],u_lightColor:[1,1,1,1],u_ambient:[.2,.2,.2,1],u_specular:[1,1,1,1],u_shininess:100,u_specularFactor:0,u_diffuse:[.5,.5,.5,1],u_world:R,u_worldInverseTranspose:s,u_worldViewProjection:u,u_worldViewPos:c}),l["default"].drawBufferInfo(t,t.TRIANGLES,this._sphereBufferInfo)}}catch(_){D=!0,F=_}finally{try{!E&&T["return"]&&T["return"]()}finally{if(D)throw F}}}}catch(_){x=!0,S=_}finally{try{!g&&I["return"]&&I["return"]()}finally{if(x)throw S}}}}}}]),t}();e["default"]=M},function(t,e,r){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e["default"]=t,e}function a(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=r(2),l=a(u),s=r(1),f=a(s),c=r(4),h=a(c),d=r(5),v=a(d),m=r(0),p=n(m),M=f["default"].vec3.fromValues(0,1,0),y=.4,_=.2,g=function(){function t(e){o(this,t),this._programInfo=l["default"].createProgramInfo(e,[v["default"],h["default"]]),this._squareBufferInfo=l["default"].primitives.createCubeBufferInfo(e,y)}return i(t,[{key:"worldAddingEntity",value:function(t){var e=t.getComponent(p.RoverComponent.Type);e&&(this._rover=e);var r=t.getComponent(p.CameraComponent.Type);r&&(this._camera=r)}},{key:"worldRemovingEntity",value:function(t){var e=t.getComponent(p.RoverComponent.Type);e&&(this._rover=null);var r=t.getComponent(p.CameraComponent.Type);r&&(this._camera=null)}},{key:"render",value:function(t,e){if(this._camera){var r=this._camera;if(this._rover){var n=this._rover,a=r.getViewMatrix(),o=f["default"].mat4.create(),i=f["default"].mat4.create(),u=f["default"].mat4.create(),s=f["default"].mat4.create(),c=f["default"].mat4.create(),h=r.getPosition();r.getLookAt();f["default"].mat4.invert(o,a),f["default"].mat4.mul(i,r.getProjectionMatrix(),a),t.enable(t.DEPTH_TEST),t.enable(t.CULL_FACE);var d=f["default"].mat4.create(),v=f["default"].mat4.create(),m=f["default"].quat.create();f["default"].quat.rotateZ(m,m,Math.PI/2),f["default"].quat.rotateZ(m,m,_*n.tilt),f["default"].quat.mul(m,n.rotation,m),f["default"].quat.mul(m,n.surfaceRotation,m),f["default"].mat4.fromQuat(v,m),f["default"].mat4.translate(d,d,n.position);var p=f["default"].vec3.clone(M);f["default"].vec3.scale(p,p,y/2),f["default"].mat4.translate(d,d,p),f["default"].mat4.mul(s,d,v),f["default"].mat4.mul(u,i,s),f["default"].mat4.invert(c,f["default"].mat4.transpose(c,s)),t.useProgram(this._programInfo.program),l["default"].setBuffersAndAttributes(t,this._programInfo,this._squareBufferInfo),l["default"].setUniforms(this._programInfo,{u_lightWorld:[0,1,0],u_lightColor:[1,1,1,1],u_ambient:[.2,.2,.2,1],u_specular:[1,1,1,1],u_shininess:100,u_specularFactor:1,u_diffuse:[.8,.8,.8,1],u_world:s,u_worldInverseTranspose:c,u_worldViewProjection:u,u_worldViewPos:h}),l["default"].drawBufferInfo(t,t.TRIANGLES,this._squareBufferInfo)}}}}]),t}();e["default"]=g},function(t,e,r){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e["default"]=t,e}function a(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=r(2),l=a(u),s=r(1),f=a(s),c=r(4),h=a(c),d=r(5),v=a(d),m=r(0),p=n(m),M=f["default"].vec3.fromValues(0,1,0),y=1,_=function(){function t(e){o(this,t),this._programInfo=l["default"].createProgramInfo(e,[v["default"],h["default"]]),this._squareBufferInfo=l["default"].primitives.createCubeBufferInfo(e,y),this._specimens=new Map}return i(t,[{key:"worldAddingEntity",value:function(t){var e=t.getComponent(p.CameraComponent.Type);e&&(this._camera=e);var r=t.getComponent(p.SpecimenComponent.Type);r&&this._specimens.set(t,r)}},{key:"worldRemovingEntity",value:function(t){var e=t.getComponent(p.CameraComponent.Type);e&&(this._camera=null);var r=t.getComponent(p.SpecimenComponent.Type);r&&this._specimens["delete"](t)}},{key:"render",value:function(t,e){if(this._camera){var r=this._camera,n=r.getViewMatrix(),a=f["default"].mat4.create(),o=f["default"].mat4.create(),i=f["default"].mat4.create(),u=f["default"].mat4.create(),s=f["default"].mat4.create(),c=r.getPosition();r.getLookAt();f["default"].mat4.invert(a,n),f["default"].mat4.mul(o,r.getProjectionMatrix(),n),t.useProgram(this._programInfo.program),l["default"].setBuffersAndAttributes(t,this._programInfo,this._squareBufferInfo),t.enable(t.DEPTH_TEST),t.enable(t.CULL_FACE);var h=!0,d=!1,v=void 0;try{for(var m,p=this._specimens[Symbol.iterator]();!(h=(m=p.next()).done);h=!0){var y=m.value,_=y[1],g=f["default"].mat4.create(),x=f["default"].mat4.create(),S=f["default"].quat.create();f["default"].quat.mul(S,_.rotation,S),f["default"].quat.mul(S,_.surfaceRotation,S),f["default"].mat4.fromQuat(x,S),f["default"].mat4.translate(g,g,_.position);var b=f["default"].vec3.clone(M);f["default"].vec3.scale(b,b,_.originalSize[0]/2),f["default"].mat4.translate(g,g,b);var I=f["default"].mat4.create();f["default"].mat4.scale(I,I,_.size),f["default"].mat4.mul(u,g,I),f["default"].mat4.mul(u,u,x),f["default"].mat4.mul(i,o,u),f["default"].mat4.invert(s,f["default"].mat4.transpose(s,u)),l["default"].setUniforms(this._programInfo,{u_lightWorld:[0,1,0],u_lightColor:[1,1,1,1],u_ambient:[.2,.2,.2,1],u_specular:[1,1,1,1],u_shininess:100,u_specularFactor:0,u_diffuse:_.color,u_world:u,u_worldInverseTranspose:s,u_worldViewProjection:i,u_worldViewPos:c}),l["default"].drawBufferInfo(t,t.TRIANGLES,this._squareBufferInfo)}}catch(w){d=!0,v=w}finally{try{!h&&p["return"]&&p["return"]()}finally{if(d)throw v}}}}}]),t}();e["default"]=_},function(t,e,r){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e["default"]=t,e}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=r(0),u=n(i),l=function(){function t(e){a(this,t),this._scoreElem=document.getElementById("score"),this._scoreElem.innerHTML="0",this._boostElem=document.getElementById("boost"),this._boostElem.style.width="0%",this._instructionsElem=document.getElementById("instructions"),this._instructionsElem.className="fade-out"}return o(t,[{key:"worldAddingEntity",value:function(t){var e=t.getComponent(u.ScoreComponent.Type);e&&(this._score=e);var r=t.getComponent(u.RoverComponent.Type);r&&(this._rover=r)}},{key:"worldRemovingEntity",value:function(t){var e=t.getComponent(u.ScoreComponent.Type);e&&(this._score=null);var r=t.getComponent(u.RoverComponent.Type);r&&(this._rover=null)}},{key:"render",value:function(t,e){if(this._score){var r=this._score;if(this._rover){var n=this._rover;r.updated?(this._scoreElem.innerHTML=r.value,this._scoreElem.className="score-change",this._updateTime=(new Date).getTime(),r.updated=!1):(new Date).getTime()-this._updateTime>200&&(this._scoreElem.className=""),this._boostElem.style.width=n.boostRemaining+"%",this._boostElem.style.backgroundColor=n.boost?"#ff0000":"#00ff00"}}}}]),t}();e["default"]=l},function(t,e,r){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e["default"]=t,e}function a(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=r(1),l=a(u),s=r(0),f=n(s),c=l["default"].vec3.fromValues(0,0,-1),h=(l["default"].vec3.fromValues(1,0,0),1.5),d=4,v=.05,m=.1,p=1.5,M=1,y=.5,_=-.5,g=.05,x=.02,S=.22,b=.44,I=32,w=128,E=.25,D=function(){function t(){var e=this;o(this,t),this.handleKeyDown=function(t){t.preventDefault(),e._keys.set(t.key,!0)},this.handleKeyUp=function(t){t.preventDefault(),e._keys.set(t.key,!1)},this._keys=new Map,this._pressed=new Map}return i(t,[{key:"systemWillMount",value:function(t,e){window.addEventListener("keydown",this.handleKeyDown),window.addEventListener("keyup",this.handleKeyUp)}},{key:"systemWillUnmount",value:function(t,e){window.removeEventListener("keydown",this.handleKeyDown),window.removeEventListener("keyup",this.handleKeyUp)}},{key:"worldAddingEntity",value:function(t){var e=t.getComponent(f.RoverComponent.Type);e&&(this._rover=e);var r=t.getComponent(f.GroundComponent.Type);r&&(this._ground=r)}},{key:"worldRemovingEntity",value:function(t){var e=t.getComponent(f.RoverComponent.Type);e&&(this._rover=null);var r=t.getComponent(f.GroundComponent.Type);r&&(this._ground=null)}},{key:"simulate",value:function(t){if(null!=this._rover){var e=this._rover;if(null!=this._ground){var r=this._ground;r.ensureChunks(e.position[0],e.position[2],I,w),e.boostRemaining+=this._keys.get(" ")?-p:M,e.boostRemaining=Math.max(Math.min(100,e.boostRemaining),0),e.boost=this._keys.get(" ")&&e.boostRemaining,e.turning=0;var n=l["default"].vec3.fromValues(0,_,0),a=!0;if(e.surfaceNormal){var o=l["default"].vec3.clone(e.surfaceNormal);l["default"].vec3.scale(o,o,_*-1),l["default"].vec3.add(n,n,o)}var i=l["default"].vec3.clone(c),u=l["default"].quat.create();if(l["default"].quat.mul(u,e.surfaceRotation,e.rotation),l["default"].vec3.transformQuat(i,i,u),this._keys.get("ArrowUp")||this._keys.get("ArrowLeft")||this._keys.get("ArrowDown")||this._keys.get("ArrowRight")){a=!1;var s=v;s*=e.boost?m:1-l["default"].vec3.length(e.velocity)/S*y;var f=((this._keys.get("ArrowLeft")?1:0)-(this._keys.get("ArrowRight")?1:0))*s;if(l["default"].quat.rotateY(e.rotation,e.rotation,f),e.turning=f?f>0?1:-1:0,e.surfaceNormal){var D=h*(e.boost?d:1);l["default"].vec3.scale(i,i,((this._keys.get("ArrowDown")?1:0)-(this._keys.get("ArrowUp")?1:0))*D),l["default"].vec3.add(n,n,i)}}e.turning?e.tilt=e.tilt+.1*(e.turning*-1-e.tilt):e.tilt=e.tilt+.1*(0-e.tilt),l["default"].vec3.scale(n,n,1/e.mass),l["default"].vec3.add(e.velocity,e.velocity,n);var F=void 0;if(e.surfaceNormal){var A=l["default"].vec3.clone(e.velocity);l["default"].vec3.normalize(A,A),l["default"].vec3.normalize(i,i),F=(1-l["default"].vec3.dot(i,A))*g}else F=0;l["default"].vec3.scale(e.velocity,e.velocity,1-F);var T=e.boost?b:S;l["default"].vec3.length(e.velocity)>T&&(l["default"].vec3.normalize(e.velocity,e.velocity),l["default"].vec3.scale(e.velocity,e.velocity,T)),a&&l["default"].vec3.length(e.velocity)<x&&l["default"].vec3.set(e.velocity,0,0,0),l["default"].vec3.add(e.position,e.position,e.velocity);var P=r.getHeightAndNormalAt(e.position[0],e.position[2]),R=!0,C=!1,O=void 0;try{for(var z,k=P.chunk.obstacles[Symbol.iterator]();!(R=(z=k.next()).done);R=!0){var U=z.value;if(l["default"].vec3.distance(U.position,e.position)<U.size[0]){var N=l["default"].vec3.create();l["default"].vec3.sub(N,U.position,e.position),l["default"].vec3.normalize(N,N),l["default"].vec3.scale(N,N,U.size[0]*-1),l["default"].vec3.add(e.position,U.position,N),l["default"].vec3.normalize(N,N),l["default"].vec3.scale(e.velocity,N,l["default"].vec3.length(e.velocity)*E)}}}catch(L){C=!0,O=L}finally{try{!R&&k["return"]&&k["return"]()}finally{if(C)throw O}}if(e.position[1]<=P.height){e.position[1]=P.height;var B=l["default"].quat.create();l["default"].quat.setAxes(B,P.binormal,P.tangent,P.normal),l["default"].quat.slerp(e.surfaceRotation,e.surfaceRotation,B,.25),e.surfaceNormal=P.normal}else e.surfaceNormal=null}}}}]),t}();e["default"]=D},function(t,e,r){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e["default"]=t,e}function a(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=r(1),l=a(u),s=r(0),f=n(s),c=r(6),h=n(c),d=l["default"].vec3.create(),v=100,m=64,p=96,M=128,y=4,_=10,g=8,x=32,S=64,b=10,I=.8,w=.03,E=function(){function t(e){o(this,t),this._specimens=new Map,this._capturing=new Map,this._herds=new Set,this._nextHerdSize=null}return i(t,[{key:"systemWillMount",value:function(t,e){this._world=t}},{key:"systemWillUnmount",value:function(t){}},{key:"worldAddingEntity",value:function(t){var e=t.getComponent(f.GroundComponent.Type);e&&(this._ground=e);var r=t.getComponent(f.ScoreComponent.Type);r&&(this._score=r);var n=t.getComponent(f.RoverComponent.Type);n&&(this._rover=n);var a=t.getComponent(f.SpecimenComponent.Type);a&&this._specimens.set(t,a)}},{key:"worldRemovingEntity",value:function(t){var e=t.getComponent(f.GroundComponent.Type);e&&(this._ground=null);var r=t.getComponent(f.ScoreComponent.Type);r&&(this._score=null);var n=t.getComponent(f.RoverComponent.Type);n&&(this._rover=null);var a=t.getComponent(f.SpecimenComponent.Type);a&&this._specimens["delete"](t)}},{key:"simulate",value:function(t){if(this._rover){var e=this._rover;if(this._ground){var r=this._ground;if(this._score){for(var n=this._score,a=0===this._specimens.size,o=a?x:m,i=a?S:p;this._specimens.size<v&&(this._nextHerdSize||(this._nextHerdSize=y+Math.floor(Math.random()*(_-y))),!(this._specimens.size+this._nextHerdSize>=v));){var u=l["default"].vec3.create(),s=o+(i-o)*Math.random();this._getRandomVec3Around(u,e.position,s);for(var c=0;c<this._nextHerdSize;++c){var d=l["default"].vec3.create(),M=g*Math.random();this._getRandomVec3Around(d,u,M);var b=Math.floor(100*Math.random())>80?f.SpecimenComponent.LARGE_TYPE:f.SpecimenComponent.SMALL_TYPE;this._world.createEntity(h.specimen,{position:d,specimenType:b})}this._nextHerdSize=null}var E=[],D=!0,F=!1,A=void 0;try{for(var T,P=this._specimens[Symbol.iterator]();!(D=(T=P.next()).done);D=!0){var R=T.value;this._update(R,e,r,n,E)}}catch(C){F=!0,A=C}finally{try{!D&&P["return"]&&P["return"]()}finally{if(F)throw A}}var O=!0,z=!1,k=void 0;try{for(var U,N=this._capturing[Symbol.iterator]();!(O=(U=N.next()).done);O=!0){var L=U.value,B=L[1];l["default"].vec3.scale(B.size,B.size,I),B.size[0]<w&&(E.push(L[0]),this._capturing["delete"](L[0]))}}catch(C){z=!0,k=C}finally{try{!O&&N["return"]&&N["return"]()}finally{if(z)throw k}}var V=!0,q=!1,j=void 0;try{for(var Y,G=E[Symbol.iterator]();!(V=(Y=G.next()).done);V=!0){var X=Y.value;this._world.removeEntity(X)}}catch(C){q=!0,j=C}finally{try{!V&&G["return"]&&G["return"]()}finally{if(q)throw j}}}}}}},{key:"_getRandomVec3Around",value:function(t,e,r){var n=l["default"].vec3.fromValues(1,0,0),a=2*Math.random()*Math.PI;return l["default"].vec3.scale(n,n,r),l["default"].vec3.rotateY(n,n,d,a),l["default"].vec3.add(t,n,e),t}},{key:"_update",value:function(t,e,r,n,a){if(!this._capturing.has(t[0])){var o=t[1],i=l["default"].vec3.distance(o.position,e.position);if(i<o.size[0])return this._capturing.set(t[0],t[1]),void n.bump(o);if(i>M)return void a.push(t[0]);if(i<b){var u=l["default"].vec3.create();l["default"].vec3.sub(u,e.position,o.position),u[1]=0,l["default"].vec3.normalize(u,u),l["default"].vec3.scale(u,u,m*-1),l["default"].vec3.add(o.startPosition,o.position,u),o.paniced=!0,o.target=null}if(!o.target){o.target=l["default"].vec3.create();var s=g*Math.random();this._getRandomVec3Around(o.target,o.startPosition,s)}if(o.target){var f=l["default"].vec3.create(),c=l["default"].vec3.clone(o.position),h=o.paniced?o.panicSpeed:o.idleSpeed;c[1]=0,l["default"].vec3.sub(f,o.target,c),l["default"].vec3.normalize(f,f),l["default"].vec3.scale(f,f,h),l["default"].vec3.add(o.position,f,o.position);var d=l["default"].vec2.fromValues(o.position[0],o.position[2]),v=l["default"].vec2.fromValues(o.target[0],o.target[2]);l["default"].vec2.distance(d,v)<=h&&(o.target=null)}var p=r.getHeightAndNormalAt(o.position[0],o.position[2]);if(p){o.position[1]=p.height;var y=l["default"].quat.create();l["default"].quat.setAxes(y,p.binormal,p.tangent,p.normal),l["default"].quat.slerp(o.surfaceRotation,o.surfaceRotation,y,.25)}}}}]),t}();e["default"]=E},function(t,e,r){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e["default"]=t,e}function a(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=r(1),l=a(u),s=r(0),f=n(s),c=l["default"].vec3.fromValues(0,0,-1),h=l["default"].vec3.fromValues(1,0,0),d=l["default"].vec3.fromValues(0,1,0),v=2,m=7,p=4,M=2,y=.05,_=.05,g=.2,x=.5,S=function(){function t(){o(this,t)}return i(t,[{key:"systemWillMount",value:function(t,e){}},{key:"systemWillUnmount",value:function(t,e){}},{key:"worldAddingEntity",value:function(t){var e=t.getComponent(f.CameraComponent.Type);e&&(this._camera=e);var r=t.getComponent(f.RoverComponent.Type);r&&(this._rover=r);var n=t.getComponent(f.GroundComponent.Type);n&&(this._ground=n)}},{key:"worldRemovingEntity",value:function(t){var e=t.getComponent(f.CameraComponent.Type);e&&(this._camera=null);var r=t.getComponent(f.RoverComponent.Type);r&&(this._rover=null);var n=t.getComponent(f.GroundComponent.Type);n&&(this._ground=null)}},{key:"simulate",value:function(t){if(null!=this._camera){var e=this._camera;if(null!=this._rover){var r=this._rover;if(null!=this._ground){var n=this._ground,a=l["default"].vec3.clone(c);l["default"].vec3.transformQuat(a,a,r.rotation),l["default"].vec3.scale(a,a,-m);var o=l["default"].vec3.create();l["default"].vec3.add(o,r.position,a);var i=(r.position,n.getHeightAndNormalAt(o[0],o[2])),u=l["default"].vec3.length(r.velocity);if(o[1]=i.height+v-u*p,o[1]<i.height+x&&(o[1]=x+i.height),r.turning){var s=l["default"].vec3.clone(h);l["default"].vec3.transformQuat(s,s,r.rotation),l["default"].vec3.scale(s,s,M*-r.turning*u),l["default"].vec3.add(s,d,s),e.setUp(s,y)}else e.setUp(d,y);e.setFocalPointAndPosition(r.position,o,g,_)}}}}}]),t}();e["default"]=S},function(t,e,r){var n=r(3),a={};a.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},a.clone=function(t){var e=new n.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},a.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},a.fromValues=function(t,e,r,a){var o=new n.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=r,o[3]=a,o},a.set=function(t,e,r,n,a){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t},a.transpose=function(t,e){if(t===e){var r=e[1];t[1]=e[2],t[2]=r}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},a.invert=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=r*o-a*n;return i?(i=1/i,t[0]=o*i,t[1]=-n*i,t[2]=-a*i,t[3]=r*i,t):null},a.adjoint=function(t,e){var r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t},a.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},a.multiply=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],u=r[0],l=r[1],s=r[2],f=r[3];return t[0]=n*u+o*l,t[1]=a*u+i*l,t[2]=n*s+o*f,t[3]=a*s+i*f,t},a.mul=a.multiply,a.rotate=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],u=Math.sin(r),l=Math.cos(r);return t[0]=n*l+o*u,t[1]=a*l+i*u,t[2]=n*-u+o*l,t[3]=a*-u+i*l,t},a.scale=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],u=r[0],l=r[1];return t[0]=n*u,t[1]=a*u,t[2]=o*l,t[3]=i*l,t},a.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t},a.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},a.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},a.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},a.LDU=function(t,e,r,n){return t[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-t[2]*r[1],[t,e,r]},a.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},a.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t},a.sub=a.subtract,a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},a.equals=function(t,e){var r=t[0],a=t[1],o=t[2],i=t[3],u=e[0],l=e[1],s=e[2],f=e[3];return Math.abs(r-u)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(a-l)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(l))&&Math.abs(o-s)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(s))&&Math.abs(i-f)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(f))},a.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},a.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t},t.exports=a},function(t,e,r){var n=r(3),a={};a.create=function(){var t=new n.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},a.clone=function(t){var e=new n.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},a.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},a.fromValues=function(t,e,r,a,o,i){var u=new n.ARRAY_TYPE(6);return u[0]=t,u[1]=e,u[2]=r,u[3]=a,u[4]=o,u[5]=i,u},a.set=function(t,e,r,n,a,o,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=o,t[5]=i,t},a.invert=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],u=e[5],l=r*o-n*a;return l?(l=1/l,t[0]=o*l,t[1]=-n*l,t[2]=-a*l,t[3]=r*l,t[4]=(a*u-o*i)*l,t[5]=(n*i-r*u)*l,t):null},a.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},a.multiply=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=r[0],f=r[1],c=r[2],h=r[3],d=r[4],v=r[5];return t[0]=n*s+o*f,t[1]=a*s+i*f,t[2]=n*c+o*h,t[3]=a*c+i*h,t[4]=n*d+o*v+u,t[5]=a*d+i*v+l,t},a.mul=a.multiply,a.rotate=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=Math.sin(r),f=Math.cos(r);return t[0]=n*f+o*s,t[1]=a*f+i*s,t[2]=n*-s+o*f,t[3]=a*-s+i*f,t[4]=u,t[5]=l,t},a.scale=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=r[0],f=r[1];return t[0]=n*s,t[1]=a*s,t[2]=o*f,t[3]=i*f,t[4]=u,t[5]=l,t},a.translate=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=r[0],f=r[1];return t[0]=n,t[1]=a,t[2]=o,t[3]=i,t[4]=n*s+o*f+u,t[5]=a*s+i*f+l,t},a.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t[4]=0,t[5]=0,t},a.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},a.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},a.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},a.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},a.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t},a.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t},a.sub=a.subtract,a.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t},a.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},a.equals=function(t,e){var r=t[0],a=t[1],o=t[2],i=t[3],u=t[4],l=t[5],s=e[0],f=e[1],c=e[2],h=e[3],d=e[4],v=e[5];return Math.abs(r-s)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(a-f)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(o-c)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(i-h)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(u-d)<=n.EPSILON*Math.max(1,Math.abs(u),Math.abs(d))&&Math.abs(l-v)<=n.EPSILON*Math.max(1,Math.abs(l),Math.abs(v))},t.exports=a},function(t,e,r){var n=r(3),a={scalar:{},SIMD:{}};a.create=function(){var t=new n.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.clone=function(t){var e=new n.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},a.copy=function(t,e){
return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.fromValues=function(t,e,r,a,o,i,u,l,s,f,c,h,d,v,m,p){var M=new n.ARRAY_TYPE(16);return M[0]=t,M[1]=e,M[2]=r,M[3]=a,M[4]=o,M[5]=i,M[6]=u,M[7]=l,M[8]=s,M[9]=f,M[10]=c,M[11]=h,M[12]=d,M[13]=v,M[14]=m,M[15]=p,M},a.set=function(t,e,r,n,a,o,i,u,l,s,f,c,h,d,v,m,p){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=o,t[5]=i,t[6]=u,t[7]=l,t[8]=s,t[9]=f,t[10]=c,t[11]=h,t[12]=d,t[13]=v,t[14]=m,t[15]=p,t},a.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.scalar.transpose=function(t,e){if(t===e){var r=e[1],n=e[2],a=e[3],o=e[6],i=e[7],u=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=o,t[11]=e[14],t[12]=a,t[13]=i,t[14]=u}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},a.SIMD.transpose=function(t,e){var r,n,a,o,i,u,l,s,f,c;return r=SIMD.Float32x4.load(e,0),n=SIMD.Float32x4.load(e,4),a=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12),i=SIMD.Float32x4.shuffle(r,n,0,1,4,5),u=SIMD.Float32x4.shuffle(a,o,0,1,4,5),l=SIMD.Float32x4.shuffle(i,u,0,2,4,6),s=SIMD.Float32x4.shuffle(i,u,1,3,5,7),SIMD.Float32x4.store(t,0,l),SIMD.Float32x4.store(t,4,s),i=SIMD.Float32x4.shuffle(r,n,2,3,6,7),u=SIMD.Float32x4.shuffle(a,o,2,3,6,7),f=SIMD.Float32x4.shuffle(i,u,0,2,4,6),c=SIMD.Float32x4.shuffle(i,u,1,3,5,7),SIMD.Float32x4.store(t,8,f),SIMD.Float32x4.store(t,12,c),t},a.transpose=n.USE_SIMD?a.SIMD.transpose:a.scalar.transpose,a.scalar.invert=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],u=e[5],l=e[6],s=e[7],f=e[8],c=e[9],h=e[10],d=e[11],v=e[12],m=e[13],p=e[14],M=e[15],y=r*u-n*i,_=r*l-a*i,g=r*s-o*i,x=n*l-a*u,S=n*s-o*u,b=a*s-o*l,I=f*m-c*v,w=f*p-h*v,E=f*M-d*v,D=c*p-h*m,F=c*M-d*m,A=h*M-d*p,T=y*A-_*F+g*D+x*E-S*w+b*I;return T?(T=1/T,t[0]=(u*A-l*F+s*D)*T,t[1]=(a*F-n*A-o*D)*T,t[2]=(m*b-p*S+M*x)*T,t[3]=(h*S-c*b-d*x)*T,t[4]=(l*E-i*A-s*w)*T,t[5]=(r*A-a*E+o*w)*T,t[6]=(p*g-v*b-M*_)*T,t[7]=(f*b-h*g+d*_)*T,t[8]=(i*F-u*E+s*I)*T,t[9]=(n*E-r*F-o*I)*T,t[10]=(v*S-m*g+M*y)*T,t[11]=(c*g-f*S-d*y)*T,t[12]=(u*w-i*D-l*I)*T,t[13]=(r*D-n*w+a*I)*T,t[14]=(m*_-v*x-p*y)*T,t[15]=(f*x-c*_+h*y)*T,t):null},a.SIMD.invert=function(t,e){var r,n,a,o,i,u,l,s,f,c,h=SIMD.Float32x4.load(e,0),d=SIMD.Float32x4.load(e,4),v=SIMD.Float32x4.load(e,8),m=SIMD.Float32x4.load(e,12);return i=SIMD.Float32x4.shuffle(h,d,0,1,4,5),n=SIMD.Float32x4.shuffle(v,m,0,1,4,5),r=SIMD.Float32x4.shuffle(i,n,0,2,4,6),n=SIMD.Float32x4.shuffle(n,i,1,3,5,7),i=SIMD.Float32x4.shuffle(h,d,2,3,6,7),o=SIMD.Float32x4.shuffle(v,m,2,3,6,7),a=SIMD.Float32x4.shuffle(i,o,0,2,4,6),o=SIMD.Float32x4.shuffle(o,i,1,3,5,7),i=SIMD.Float32x4.mul(a,o),i=SIMD.Float32x4.swizzle(i,1,0,3,2),u=SIMD.Float32x4.mul(n,i),l=SIMD.Float32x4.mul(r,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,i),u),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,i),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),i=SIMD.Float32x4.mul(n,a),i=SIMD.Float32x4.swizzle(i,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),u),f=SIMD.Float32x4.mul(r,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(o,i)),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,i),f),f=SIMD.Float32x4.swizzle(f,2,3,0,1),i=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(n,2,3,0,1),o),i=SIMD.Float32x4.swizzle(i,1,0,3,2),a=SIMD.Float32x4.swizzle(a,2,3,0,1),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,i),u),s=SIMD.Float32x4.mul(r,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(a,i)),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,i),s),s=SIMD.Float32x4.swizzle(s,2,3,0,1),i=SIMD.Float32x4.mul(r,n),i=SIMD.Float32x4.swizzle(i,1,0,3,2),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),s),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,i),f),i=SIMD.Float32x4.swizzle(i,2,3,0,1),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,i),s),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(a,i)),i=SIMD.Float32x4.mul(r,o),i=SIMD.Float32x4.swizzle(i,1,0,3,2),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(a,i)),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,i),s),i=SIMD.Float32x4.swizzle(i,2,3,0,1),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,i),l),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(n,i)),i=SIMD.Float32x4.mul(r,a),i=SIMD.Float32x4.swizzle(i,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),l),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(n,i)),i=SIMD.Float32x4.swizzle(i,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(o,i)),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,i),f),c=SIMD.Float32x4.mul(r,u),c=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(c,2,3,0,1),c),c=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(c,1,0,3,2),c),i=SIMD.Float32x4.reciprocalApproximation(c),c=SIMD.Float32x4.sub(SIMD.Float32x4.add(i,i),SIMD.Float32x4.mul(c,SIMD.Float32x4.mul(i,i))),(c=SIMD.Float32x4.swizzle(c,0,0,0,0))?(SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(c,u)),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(c,l)),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(c,s)),SIMD.Float32x4.store(t,12,SIMD.Float32x4.mul(c,f)),t):null},a.invert=n.USE_SIMD?a.SIMD.invert:a.scalar.invert,a.scalar.adjoint=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],u=e[5],l=e[6],s=e[7],f=e[8],c=e[9],h=e[10],d=e[11],v=e[12],m=e[13],p=e[14],M=e[15];return t[0]=u*(h*M-d*p)-c*(l*M-s*p)+m*(l*d-s*h),t[1]=-(n*(h*M-d*p)-c*(a*M-o*p)+m*(a*d-o*h)),t[2]=n*(l*M-s*p)-u*(a*M-o*p)+m*(a*s-o*l),t[3]=-(n*(l*d-s*h)-u*(a*d-o*h)+c*(a*s-o*l)),t[4]=-(i*(h*M-d*p)-f*(l*M-s*p)+v*(l*d-s*h)),t[5]=r*(h*M-d*p)-f*(a*M-o*p)+v*(a*d-o*h),t[6]=-(r*(l*M-s*p)-i*(a*M-o*p)+v*(a*s-o*l)),t[7]=r*(l*d-s*h)-i*(a*d-o*h)+f*(a*s-o*l),t[8]=i*(c*M-d*m)-f*(u*M-s*m)+v*(u*d-s*c),t[9]=-(r*(c*M-d*m)-f*(n*M-o*m)+v*(n*d-o*c)),t[10]=r*(u*M-s*m)-i*(n*M-o*m)+v*(n*s-o*u),t[11]=-(r*(u*d-s*c)-i*(n*d-o*c)+f*(n*s-o*u)),t[12]=-(i*(c*p-h*m)-f*(u*p-l*m)+v*(u*h-l*c)),t[13]=r*(c*p-h*m)-f*(n*p-a*m)+v*(n*h-a*c),t[14]=-(r*(u*p-l*m)-i*(n*p-a*m)+v*(n*l-a*u)),t[15]=r*(u*h-l*c)-i*(n*h-a*c)+f*(n*l-a*u),t},a.SIMD.adjoint=function(t,e){var r,n,a,o,i,u,l,s,f,c,h,d,v,r=SIMD.Float32x4.load(e,0),n=SIMD.Float32x4.load(e,4),a=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12);return f=SIMD.Float32x4.shuffle(r,n,0,1,4,5),u=SIMD.Float32x4.shuffle(a,o,0,1,4,5),i=SIMD.Float32x4.shuffle(f,u,0,2,4,6),u=SIMD.Float32x4.shuffle(u,f,1,3,5,7),f=SIMD.Float32x4.shuffle(r,n,2,3,6,7),s=SIMD.Float32x4.shuffle(a,o,2,3,6,7),l=SIMD.Float32x4.shuffle(f,s,0,2,4,6),s=SIMD.Float32x4.shuffle(s,f,1,3,5,7),f=SIMD.Float32x4.mul(l,s),f=SIMD.Float32x4.swizzle(f,1,0,3,2),c=SIMD.Float32x4.mul(u,f),h=SIMD.Float32x4.mul(i,f),f=SIMD.Float32x4.swizzle(f,2,3,0,1),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,f),c),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,f),h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),f=SIMD.Float32x4.mul(u,l),f=SIMD.Float32x4.swizzle(f,1,0,3,2),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,f),c),v=SIMD.Float32x4.mul(i,f),f=SIMD.Float32x4.swizzle(f,2,3,0,1),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(s,f)),v=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,f),v),v=SIMD.Float32x4.swizzle(v,2,3,0,1),f=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,2,3,0,1),s),f=SIMD.Float32x4.swizzle(f,1,0,3,2),l=SIMD.Float32x4.swizzle(l,2,3,0,1),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,f),c),d=SIMD.Float32x4.mul(i,f),f=SIMD.Float32x4.swizzle(f,2,3,0,1),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(l,f)),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,f),d),d=SIMD.Float32x4.swizzle(d,2,3,0,1),f=SIMD.Float32x4.mul(i,u),f=SIMD.Float32x4.swizzle(f,1,0,3,2),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,f),d),v=SIMD.Float32x4.sub(SIMD.Float32x4.mul(l,f),v),f=SIMD.Float32x4.swizzle(f,2,3,0,1),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,f),d),v=SIMD.Float32x4.sub(v,SIMD.Float32x4.mul(l,f)),f=SIMD.Float32x4.mul(i,s),f=SIMD.Float32x4.swizzle(f,1,0,3,2),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(l,f)),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,f),d),f=SIMD.Float32x4.swizzle(f,2,3,0,1),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,f),h),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(u,f)),f=SIMD.Float32x4.mul(i,l),f=SIMD.Float32x4.swizzle(f,1,0,3,2),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,f),h),v=SIMD.Float32x4.sub(v,SIMD.Float32x4.mul(u,f)),f=SIMD.Float32x4.swizzle(f,2,3,0,1),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(s,f)),v=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,f),v),SIMD.Float32x4.store(t,0,c),SIMD.Float32x4.store(t,4,h),SIMD.Float32x4.store(t,8,d),SIMD.Float32x4.store(t,12,v),t},a.adjoint=n.USE_SIMD?a.SIMD.adjoint:a.scalar.adjoint,a.determinant=function(t){var e=t[0],r=t[1],n=t[2],a=t[3],o=t[4],i=t[5],u=t[6],l=t[7],s=t[8],f=t[9],c=t[10],h=t[11],d=t[12],v=t[13],m=t[14],p=t[15],M=e*i-r*o,y=e*u-n*o,_=e*l-a*o,g=r*u-n*i,x=r*l-a*i,S=n*l-a*u,b=s*v-f*d,I=s*m-c*d,w=s*p-h*d,E=f*m-c*v,D=f*p-h*v,F=c*p-h*m;return M*F-y*D+_*E+g*w-x*I+S*b},a.SIMD.multiply=function(t,e,r){var n=SIMD.Float32x4.load(e,0),a=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8),i=SIMD.Float32x4.load(e,12),u=SIMD.Float32x4.load(r,0),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,3,3,3,3),i))));SIMD.Float32x4.store(t,0,l);var s=SIMD.Float32x4.load(r,4),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,3,3,3,3),i))));SIMD.Float32x4.store(t,4,f);var c=SIMD.Float32x4.load(r,8),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,3,3,3,3),i))));SIMD.Float32x4.store(t,8,h);var d=SIMD.Float32x4.load(r,12),v=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,3,3,3,3),i))));return SIMD.Float32x4.store(t,12,v),t},a.scalar.multiply=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=e[6],f=e[7],c=e[8],h=e[9],d=e[10],v=e[11],m=e[12],p=e[13],M=e[14],y=e[15],_=r[0],g=r[1],x=r[2],S=r[3];return t[0]=_*n+g*u+x*c+S*m,t[1]=_*a+g*l+x*h+S*p,t[2]=_*o+g*s+x*d+S*M,t[3]=_*i+g*f+x*v+S*y,_=r[4],g=r[5],x=r[6],S=r[7],t[4]=_*n+g*u+x*c+S*m,t[5]=_*a+g*l+x*h+S*p,t[6]=_*o+g*s+x*d+S*M,t[7]=_*i+g*f+x*v+S*y,_=r[8],g=r[9],x=r[10],S=r[11],t[8]=_*n+g*u+x*c+S*m,t[9]=_*a+g*l+x*h+S*p,t[10]=_*o+g*s+x*d+S*M,t[11]=_*i+g*f+x*v+S*y,_=r[12],g=r[13],x=r[14],S=r[15],t[12]=_*n+g*u+x*c+S*m,t[13]=_*a+g*l+x*h+S*p,t[14]=_*o+g*s+x*d+S*M,t[15]=_*i+g*f+x*v+S*y,t},a.multiply=n.USE_SIMD?a.SIMD.multiply:a.scalar.multiply,a.mul=a.multiply,a.scalar.translate=function(t,e,r){var n,a,o,i,u,l,s,f,c,h,d,v,m=r[0],p=r[1],M=r[2];return e===t?(t[12]=e[0]*m+e[4]*p+e[8]*M+e[12],t[13]=e[1]*m+e[5]*p+e[9]*M+e[13],t[14]=e[2]*m+e[6]*p+e[10]*M+e[14],t[15]=e[3]*m+e[7]*p+e[11]*M+e[15]):(n=e[0],a=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=e[6],f=e[7],c=e[8],h=e[9],d=e[10],v=e[11],t[0]=n,t[1]=a,t[2]=o,t[3]=i,t[4]=u,t[5]=l,t[6]=s,t[7]=f,t[8]=c,t[9]=h,t[10]=d,t[11]=v,t[12]=n*m+u*p+c*M+e[12],t[13]=a*m+l*p+h*M+e[13],t[14]=o*m+s*p+d*M+e[14],t[15]=i*m+f*p+v*M+e[15]),t},a.SIMD.translate=function(t,e,r){var n=SIMD.Float32x4.load(e,0),a=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8),i=SIMD.Float32x4.load(e,12),u=SIMD.Float32x4(r[0],r[1],r[2],0);e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11]),n=SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(u,0,0,0,0)),a=SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(u,1,1,1,1)),o=SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(u,2,2,2,2));var l=SIMD.Float32x4.add(n,SIMD.Float32x4.add(a,SIMD.Float32x4.add(o,i)));return SIMD.Float32x4.store(t,12,l),t},a.translate=n.USE_SIMD?a.SIMD.translate:a.scalar.translate,a.scalar.scale=function(t,e,r){var n=r[0],a=r[1],o=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*a,t[5]=e[5]*a,t[6]=e[6]*a,t[7]=e[7]*a,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.SIMD.scale=function(t,e,r){var n,a,o,i=SIMD.Float32x4(r[0],r[1],r[2],0);return n=SIMD.Float32x4.load(e,0),SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(i,0,0,0,0))),a=SIMD.Float32x4.load(e,4),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(i,1,1,1,1))),o=SIMD.Float32x4.load(e,8),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(i,2,2,2,2))),t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.scale=n.USE_SIMD?a.SIMD.scale:a.scalar.scale,a.rotate=function(t,e,r,a){var o,i,u,l,s,f,c,h,d,v,m,p,M,y,_,g,x,S,b,I,w,E,D,F,A=a[0],T=a[1],P=a[2],R=Math.sqrt(A*A+T*T+P*P);return Math.abs(R)<n.EPSILON?null:(R=1/R,A*=R,T*=R,P*=R,o=Math.sin(r),i=Math.cos(r),u=1-i,l=e[0],s=e[1],f=e[2],c=e[3],h=e[4],d=e[5],v=e[6],m=e[7],p=e[8],M=e[9],y=e[10],_=e[11],g=A*A*u+i,x=T*A*u+P*o,S=P*A*u-T*o,b=A*T*u-P*o,I=T*T*u+i,w=P*T*u+A*o,E=A*P*u+T*o,D=T*P*u-A*o,F=P*P*u+i,t[0]=l*g+h*x+p*S,t[1]=s*g+d*x+M*S,t[2]=f*g+v*x+y*S,t[3]=c*g+m*x+_*S,t[4]=l*b+h*I+p*w,t[5]=s*b+d*I+M*w,t[6]=f*b+v*I+y*w,t[7]=c*b+m*I+_*w,t[8]=l*E+h*D+p*F,t[9]=s*E+d*D+M*F,t[10]=f*E+v*D+y*F,t[11]=c*E+m*D+_*F,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},a.scalar.rotateX=function(t,e,r){var n=Math.sin(r),a=Math.cos(r),o=e[4],i=e[5],u=e[6],l=e[7],s=e[8],f=e[9],c=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*a+s*n,t[5]=i*a+f*n,t[6]=u*a+c*n,t[7]=l*a+h*n,t[8]=s*a-o*n,t[9]=f*a-i*n,t[10]=c*a-u*n,t[11]=h*a-l*n,t},a.SIMD.rotateX=function(t,e,r){var n=SIMD.Float32x4.splat(Math.sin(r)),a=SIMD.Float32x4.splat(Math.cos(r));e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,4),i=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),SIMD.Float32x4.mul(i,n))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,a),SIMD.Float32x4.mul(o,n))),t},a.rotateX=n.USE_SIMD?a.SIMD.rotateX:a.scalar.rotateX,a.scalar.rotateY=function(t,e,r){var n=Math.sin(r),a=Math.cos(r),o=e[0],i=e[1],u=e[2],l=e[3],s=e[8],f=e[9],c=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*a-s*n,t[1]=i*a-f*n,t[2]=u*a-c*n,t[3]=l*a-h*n,t[8]=o*n+s*a,t[9]=i*n+f*a,t[10]=u*n+c*a,t[11]=l*n+h*a,t},a.SIMD.rotateY=function(t,e,r){var n=SIMD.Float32x4.splat(Math.sin(r)),a=SIMD.Float32x4.splat(Math.cos(r));e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,0),i=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,a),SIMD.Float32x4.mul(i,n))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,n),SIMD.Float32x4.mul(i,a))),t},a.rotateY=n.USE_SIMD?a.SIMD.rotateY:a.scalar.rotateY,a.scalar.rotateZ=function(t,e,r){var n=Math.sin(r),a=Math.cos(r),o=e[0],i=e[1],u=e[2],l=e[3],s=e[4],f=e[5],c=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*a+s*n,t[1]=i*a+f*n,t[2]=u*a+c*n,t[3]=l*a+h*n,t[4]=s*a-o*n,t[5]=f*a-i*n,t[6]=c*a-u*n,t[7]=h*a-l*n,t},a.SIMD.rotateZ=function(t,e,r){var n=SIMD.Float32x4.splat(Math.sin(r)),a=SIMD.Float32x4.splat(Math.cos(r));e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,0),i=SIMD.Float32x4.load(e,4);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),SIMD.Float32x4.mul(i,n))),SIMD.Float32x4.store(t,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,a),SIMD.Float32x4.mul(o,n))),t},a.rotateZ=n.USE_SIMD?a.SIMD.rotateZ:a.scalar.rotateZ,a.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},a.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.fromRotation=function(t,e,r){var a,o,i,u=r[0],l=r[1],s=r[2],f=Math.sqrt(u*u+l*l+s*s);return Math.abs(f)<n.EPSILON?null:(f=1/f,u*=f,l*=f,s*=f,a=Math.sin(e),o=Math.cos(e),i=1-o,t[0]=u*u*i+o,t[1]=l*u*i+s*a,t[2]=s*u*i-l*a,t[3]=0,t[4]=u*l*i-s*a,t[5]=l*l*i+o,t[6]=s*l*i+u*a,t[7]=0,t[8]=u*s*i+l*a,t[9]=l*s*i-u*a,t[10]=s*s*i+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},a.fromXRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.fromYRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.fromZRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.fromRotationTranslation=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],u=n+n,l=a+a,s=o+o,f=n*u,c=n*l,h=n*s,d=a*l,v=a*s,m=o*s,p=i*u,M=i*l,y=i*s;return t[0]=1-(d+m),t[1]=c+y,t[2]=h-M,t[3]=0,t[4]=c-y,t[5]=1-(f+m),t[6]=v+p,t[7]=0,t[8]=h+M,t[9]=v-p,t[10]=1-(f+d),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},a.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},a.getRotation=function(t,e){var r=e[0]+e[5]+e[10],n=0;return r>0?(n=2*Math.sqrt(r+1),t[3]=.25*n,t[0]=(e[6]-e[9])/n,t[1]=(e[8]-e[2])/n,t[2]=(e[1]-e[4])/n):e[0]>e[5]&e[0]>e[10]?(n=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/n,t[0]=.25*n,t[1]=(e[1]+e[4])/n,t[2]=(e[8]+e[2])/n):e[5]>e[10]?(n=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/n,t[0]=(e[1]+e[4])/n,t[1]=.25*n,t[2]=(e[6]+e[9])/n):(n=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/n,t[0]=(e[8]+e[2])/n,t[1]=(e[6]+e[9])/n,t[2]=.25*n),t},a.fromRotationTranslationScale=function(t,e,r,n){var a=e[0],o=e[1],i=e[2],u=e[3],l=a+a,s=o+o,f=i+i,c=a*l,h=a*s,d=a*f,v=o*s,m=o*f,p=i*f,M=u*l,y=u*s,_=u*f,g=n[0],x=n[1],S=n[2];return t[0]=(1-(v+p))*g,t[1]=(h+_)*g,t[2]=(d-y)*g,t[3]=0,t[4]=(h-_)*x,t[5]=(1-(c+p))*x,t[6]=(m+M)*x,t[7]=0,t[8]=(d+y)*S,t[9]=(m-M)*S,t[10]=(1-(c+v))*S,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},a.fromRotationTranslationScaleOrigin=function(t,e,r,n,a){var o=e[0],i=e[1],u=e[2],l=e[3],s=o+o,f=i+i,c=u+u,h=o*s,d=o*f,v=o*c,m=i*f,p=i*c,M=u*c,y=l*s,_=l*f,g=l*c,x=n[0],S=n[1],b=n[2],I=a[0],w=a[1],E=a[2];return t[0]=(1-(m+M))*x,t[1]=(d+g)*x,t[2]=(v-_)*x,t[3]=0,t[4]=(d-g)*S,t[5]=(1-(h+M))*S,t[6]=(p+y)*S,t[7]=0,t[8]=(v+_)*b,t[9]=(p-y)*b,t[10]=(1-(h+m))*b,t[11]=0,t[12]=r[0]+I-(t[0]*I+t[4]*w+t[8]*E),t[13]=r[1]+w-(t[1]*I+t[5]*w+t[9]*E),t[14]=r[2]+E-(t[2]*I+t[6]*w+t[10]*E),t[15]=1,t},a.fromQuat=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=r+r,u=n+n,l=a+a,s=r*i,f=n*i,c=n*u,h=a*i,d=a*u,v=a*l,m=o*i,p=o*u,M=o*l;return t[0]=1-c-v,t[1]=f+M,t[2]=h-p,t[3]=0,t[4]=f-M,t[5]=1-s-v,t[6]=d+m,t[7]=0,t[8]=h+p,t[9]=d-m,t[10]=1-s-c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.frustum=function(t,e,r,n,a,o,i){var u=1/(r-e),l=1/(a-n),s=1/(o-i);return t[0]=2*o*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*l,t[6]=0,t[7]=0,t[8]=(r+e)*u,t[9]=(a+n)*l,t[10]=(i+o)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=i*o*2*s,t[15]=0,t},a.perspective=function(t,e,r,n,a){var o=1/Math.tan(e/2),i=1/(n-a);return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(a+n)*i,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*a*n*i,t[15]=0,t},a.perspectiveFromFieldOfView=function(t,e,r,n){var a=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),i=Math.tan(e.leftDegrees*Math.PI/180),u=Math.tan(e.rightDegrees*Math.PI/180),l=2/(i+u),s=2/(a+o);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=-((i-u)*l*.5),t[9]=(a-o)*s*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t},a.ortho=function(t,e,r,n,a,o,i){var u=1/(e-r),l=1/(n-a),s=1/(o-i);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*s,t[11]=0,t[12]=(e+r)*u,t[13]=(a+n)*l,t[14]=(i+o)*s,t[15]=1,t},a.lookAt=function(t,e,r,o){var i,u,l,s,f,c,h,d,v,m,p=e[0],M=e[1],y=e[2],_=o[0],g=o[1],x=o[2],S=r[0],b=r[1],I=r[2];return Math.abs(p-S)<n.EPSILON&&Math.abs(M-b)<n.EPSILON&&Math.abs(y-I)<n.EPSILON?a.identity(t):(h=p-S,d=M-b,v=y-I,m=1/Math.sqrt(h*h+d*d+v*v),h*=m,d*=m,v*=m,i=g*v-x*d,u=x*h-_*v,l=_*d-g*h,m=Math.sqrt(i*i+u*u+l*l),m?(m=1/m,i*=m,u*=m,l*=m):(i=0,u=0,l=0),s=d*l-v*u,f=v*i-h*l,c=h*u-d*i,m=Math.sqrt(s*s+f*f+c*c),m?(m=1/m,s*=m,f*=m,c*=m):(s=0,f=0,c=0),t[0]=i,t[1]=s,t[2]=h,t[3]=0,t[4]=u,t[5]=f,t[6]=d,t[7]=0,t[8]=l,t[9]=c,t[10]=v,t[11]=0,t[12]=-(i*p+u*M+l*y),t[13]=-(s*p+f*M+c*y),t[14]=-(h*p+d*M+v*y),t[15]=1,t)},a.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},a.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},a.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t},a.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t},a.sub=a.subtract,a.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t},a.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t[9]=e[9]+r[9]*n,t[10]=e[10]+r[10]*n,t[11]=e[11]+r[11]*n,t[12]=e[12]+r[12]*n,t[13]=e[13]+r[13]*n,t[14]=e[14]+r[14]*n,t[15]=e[15]+r[15]*n,t},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},a.equals=function(t,e){var r=t[0],a=t[1],o=t[2],i=t[3],u=t[4],l=t[5],s=t[6],f=t[7],c=t[8],h=t[9],d=t[10],v=t[11],m=t[12],p=t[13],M=t[14],y=t[15],_=e[0],g=e[1],x=e[2],S=e[3],b=e[4],I=e[5],w=e[6],E=e[7],D=e[8],F=e[9],A=e[10],T=e[11],P=e[12],R=e[13],C=e[14],O=e[15];return Math.abs(r-_)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(_))&&Math.abs(a-g)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(g))&&Math.abs(o-x)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(i-S)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(S))&&Math.abs(u-b)<=n.EPSILON*Math.max(1,Math.abs(u),Math.abs(b))&&Math.abs(l-I)<=n.EPSILON*Math.max(1,Math.abs(l),Math.abs(I))&&Math.abs(s-w)<=n.EPSILON*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(f-E)<=n.EPSILON*Math.max(1,Math.abs(f),Math.abs(E))&&Math.abs(c-D)<=n.EPSILON*Math.max(1,Math.abs(c),Math.abs(D))&&Math.abs(h-F)<=n.EPSILON*Math.max(1,Math.abs(h),Math.abs(F))&&Math.abs(d-A)<=n.EPSILON*Math.max(1,Math.abs(d),Math.abs(A))&&Math.abs(v-T)<=n.EPSILON*Math.max(1,Math.abs(v),Math.abs(T))&&Math.abs(m-P)<=n.EPSILON*Math.max(1,Math.abs(m),Math.abs(P))&&Math.abs(p-R)<=n.EPSILON*Math.max(1,Math.abs(p),Math.abs(R))&&Math.abs(M-C)<=n.EPSILON*Math.max(1,Math.abs(M),Math.abs(C))&&Math.abs(y-O)<=n.EPSILON*Math.max(1,Math.abs(y),Math.abs(O))},t.exports=a},function(t,e,r){var n=r(3),a=r(7),o=r(8),i=r(9),u={};u.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},u.rotationTo=function(){var t=o.create(),e=o.fromValues(1,0,0),r=o.fromValues(0,1,0);return function(n,a,i){var l=o.dot(a,i);return l<-.999999?(o.cross(t,e,a),o.length(t)<1e-6&&o.cross(t,r,a),o.normalize(t,t),u.setAxisAngle(n,t,Math.PI),n):l>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(o.cross(t,a,i),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+l,u.normalize(n,n))}}(),u.setAxes=function(){var t=a.create();return function(e,r,n,a){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=a[0],t[4]=a[1],t[7]=a[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],u.normalize(e,u.fromMat3(e,t))}}(),u.clone=i.clone,u.fromValues=i.fromValues,u.copy=i.copy,u.set=i.set,u.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},u.setAxisAngle=function(t,e,r){r=.5*r;var n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t},u.getAxisAngle=function(t,e){var r=2*Math.acos(e[3]),n=Math.sin(r/2);return 0!=n?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=1,t[1]=0,t[2]=0),r},u.add=i.add,u.multiply=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],u=r[0],l=r[1],s=r[2],f=r[3];return t[0]=n*f+i*u+a*s-o*l,t[1]=a*f+i*l+o*u-n*s,t[2]=o*f+i*s+n*l-a*u,t[3]=i*f-n*u-a*l-o*s,t},u.mul=u.multiply,u.scale=i.scale,u.rotateX=function(t,e,r){r*=.5;var n=e[0],a=e[1],o=e[2],i=e[3],u=Math.sin(r),l=Math.cos(r);return t[0]=n*l+i*u,t[1]=a*l+o*u,t[2]=o*l-a*u,t[3]=i*l-n*u,t},u.rotateY=function(t,e,r){r*=.5;var n=e[0],a=e[1],o=e[2],i=e[3],u=Math.sin(r),l=Math.cos(r);return t[0]=n*l-o*u,t[1]=a*l+i*u,t[2]=o*l+n*u,t[3]=i*l-a*u,t},u.rotateZ=function(t,e,r){r*=.5;var n=e[0],a=e[1],o=e[2],i=e[3],u=Math.sin(r),l=Math.cos(r);return t[0]=n*l+a*u,t[1]=a*l-n*u,t[2]=o*l+i*u,t[3]=i*l-o*u,t},u.calculateW=function(t,e){var r=e[0],n=e[1],a=e[2];return t[0]=r,t[1]=n,t[2]=a,t[3]=Math.sqrt(Math.abs(1-r*r-n*n-a*a)),t},u.dot=i.dot,u.lerp=i.lerp,u.slerp=function(t,e,r,n){var a,o,i,u,l,s=e[0],f=e[1],c=e[2],h=e[3],d=r[0],v=r[1],m=r[2],p=r[3];return o=s*d+f*v+c*m+h*p,o<0&&(o=-o,d=-d,v=-v,m=-m,p=-p),1-o>1e-6?(a=Math.acos(o),i=Math.sin(a),u=Math.sin((1-n)*a)/i,l=Math.sin(n*a)/i):(u=1-n,l=n),t[0]=u*s+l*d,t[1]=u*f+l*v,t[2]=u*c+l*m,t[3]=u*h+l*p,t},u.sqlerp=function(){var t=u.create(),e=u.create();return function(r,n,a,o,i,l){return u.slerp(t,n,i,l),u.slerp(e,a,o,l),u.slerp(r,t,e,2*l*(1-l)),r}}(),u.invert=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=r*r+n*n+a*a+o*o,u=i?1/i:0;return t[0]=-r*u,t[1]=-n*u,t[2]=-a*u,t[3]=o*u,t},u.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},u.length=i.length,u.len=u.length,u.squaredLength=i.squaredLength,u.sqrLen=u.squaredLength,u.normalize=i.normalize,u.fromMat3=function(t,e){var r,n=e[0]+e[4]+e[8];if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var a=0;e[4]>e[0]&&(a=1),e[8]>e[3*a+a]&&(a=2);var o=(a+1)%3,i=(a+2)%3;r=Math.sqrt(e[3*a+a]-e[3*o+o]-e[3*i+i]+1),t[a]=.5*r,r=.5/r,t[3]=(e[3*o+i]-e[3*i+o])*r,t[o]=(e[3*o+a]+e[3*a+o])*r,t[i]=(e[3*i+a]+e[3*a+i])*r}return t},u.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},u.exactEquals=i.exactEquals,u.equals=i.equals,t.exports=u},function(t,e,r){var n=r(3),a={};a.create=function(){var t=new n.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},a.clone=function(t){var e=new n.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},a.fromValues=function(t,e){var r=new n.ARRAY_TYPE(2);return r[0]=t,r[1]=e,r},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},a.set=function(t,e,r){return t[0]=e,t[1]=r,t},a.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t},a.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t},a.sub=a.subtract,a.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t},a.mul=a.multiply,a.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t},a.div=a.divide,a.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},a.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},a.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t},a.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t},a.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},a.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t},a.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t},a.distance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(r*r+n*n)},a.dist=a.distance,a.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1];return r*r+n*n},a.sqrDist=a.squaredDistance,a.length=function(t){var e=t[0],r=t[1];return Math.sqrt(e*e+r*r)},a.len=a.length,a.squaredLength=function(t){var e=t[0],r=t[1];return e*e+r*r},a.sqrLen=a.squaredLength,a.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},a.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},a.normalize=function(t,e){var r=e[0],n=e[1],a=r*r+n*n;return a>0&&(a=1/Math.sqrt(a),t[0]=e[0]*a,t[1]=e[1]*a),t},a.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},a.cross=function(t,e,r){var n=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=n,t},a.lerp=function(t,e,r,n){var a=e[0],o=e[1];return t[0]=a+n*(r[0]-a),t[1]=o+n*(r[1]-o),t},a.random=function(t,e){e=e||1;var r=2*n.RANDOM()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t},a.transformMat2=function(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[2]*a,t[1]=r[1]*n+r[3]*a,t},a.transformMat2d=function(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[2]*a+r[4],t[1]=r[1]*n+r[3]*a+r[5],t},a.transformMat3=function(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[3]*a+r[6],t[1]=r[1]*n+r[4]*a+r[7],t},a.transformMat4=function(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[4]*a+r[12],t[1]=r[1]*n+r[5]*a+r[13],t},a.forEach=function(){var t=a.create();return function(e,r,n,a,o,i){var u,l;for(r||(r=2),n||(n=0),l=a?Math.min(a*r+n,e.length):e.length,u=n;u<l;u+=r)t[0]=e[u],t[1]=e[u+1],o(t,t,i),e[u]=t[0],e[u+1]=t[1];return e}}(),a.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},a.equals=function(t,e){var r=t[0],a=t[1],o=e[0],i=e[1];return Math.abs(r-o)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(a-i)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(i))},t.exports=a}]);
